<!DOCTYPE html>
<html lang="en"><head>
<script src="03_classicmachinelearning_2023_files/libs/clipboard/clipboard.min.js"></script>
<script src="03_classicmachinelearning_2023_files/libs/quarto-html/tabby.min.js"></script>
<script src="03_classicmachinelearning_2023_files/libs/quarto-html/popper.min.js"></script>
<script src="03_classicmachinelearning_2023_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="03_classicmachinelearning_2023_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="03_classicmachinelearning_2023_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="03_classicmachinelearning_2023_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.1.251">

  <meta name="author" content="Dr.&nbsp;Philipp K. Masur">
  <title>Text Classification Using Classic Machine Learning</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="03_classicmachinelearning_2023_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="03_classicmachinelearning_2023_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="03_classicmachinelearning_2023_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="03_classicmachinelearning_2023_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="03_classicmachinelearning_2023_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="03_classicmachinelearning_2023_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="03_classicmachinelearning_2023_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="https://storage.googleapis.com/exenzo-jobboard/bb/public/thumb/logo-jpg-57.jpg" data-background-position="top right" data-background-size="auto" class="center">
  <h1 class="title">Text Classification Using Classic Machine Learning</h1>
  <p class="subtitle">Week 3: From Naive Bayes to Neural Networks</p>
  <p class="author">Dr.&nbsp;Philipp K. Masur</p>
</section>

<section id="section" class="slide level2" data-background="#43464B" data-background-video="video/ml.mp4" data-background-video-loop="true" data-background-video-muted="true">
<h2></h2>
</section>
<section id="so-what-are-we-actually-talking-about" class="slide level2">
<h2>So what are we actually talking about?</h2>
<ul>
<li><p>Machine learning is the study of computer algorithms that can <strong>improve automatically</strong> through experience and by the use of data</p></li>
<li><p>The field originated in an environment where the available data, statistical methods, and computing power rapidly and simultaneously evolved</p></li>
<li><p>Due to the “black box” nature of the algorithm’s operations, it is often seen as a form of <strong>artificial intelligence</strong></p></li>
</ul>

<img data-src="https://www.qlik.com/us/-/media/images/global-us/site-content/augmented-analytics/machine-learning-vs-ai/machine-learning-diagram-image.png" class="r-stretch quarto-figure-center"><p class="caption">Source: qlik</p></section>
<section id="some-success-stories" class="slide level2">
<h2>Some success stories</h2>
<p><img data-src="https://www.electricmotorengineering.com/files/2020/07/Autonomous-driving-Barcelona.jpg" style="float: right; padding-left: 40px;" width="400" alt="Source: Eschenzweig/Wikimedia">Applying machine learning in practical context:</p>
<ul>
<li>Identification of spam messages in mails</li>
<li>Segmentation of customers for targeted advertising</li>
<li>Weather forecasts and long-term climate changes</li>
<li>Reduction of fraudulent credit card transactions</li>
<li>Prediction of election outcomes</li>
<li>Auto-piloting and self-driving cars</li>
<li>Face recognition</li>
<li>Optimization of energy use in homes and buildings</li>
<li>Discovery of genetic sequences linked to diseases -….</li>
</ul>
</section>
<section id="content-of-this-lecture" class="slide level2 smaller">
<h2>Content of this lecture</h2>
<div class="columns">
<div class="column" style="width:45%;">
<ol type="1">
<li><p>What is Machine Learning?</p>
<p>1.1. Concepts and Principles</p>
<p>1.2. The General Machine Learning Pipeline</p>
<p>1.3. Difference between statistics and machine learning</p>
<p>1.4. Over- vs.&nbsp;underfitting</p>
<p>1.5. Training vs.&nbsp;Testing</p>
<p>1.6. Example Data: Predicting Genre from Lyrics</p></li>
<li><p>Supervised text classification with different “algorithms”</p>
<p>2.1. Naive Bayes</p>
<p>2.2. Logistic Regression</p>
<p>2.3. Support Vector Machines</p>
<p>2.4. Artificial Neural Networks</p></li>
</ol>
</div><div class="column" style="width:45%;">
<ol start="3" type="1">
<li><p>Testing Different Approaches</p>
<p>3.1. Performance of different approaches</p>
<p>3.2. Fine-tuning preprocessing and hyperparameters</p>
<p>3.3. Effect of text preprocessing</p>
<p>3.4. Validity of different text classification approaches</p></li>
<li><p>Examples from the Literature</p>
<p>4.1. Incivility on Facebook (Su et al., 2018)</p>
<p>4.2. Electoral News Sharing (de León et al., 2021)</p></li>
<li><p>Summary and Conclusion</p></li>
</ol>
</div>
</div>
</section>
<section>
<section id="what-is-machine-learning" class="title-slide slide level1 center" data-background-color="steelblue">
<h1>What is machine learning?</h1>

</section>
<section id="deductive-vs.-inductive-approaches" class="slide level2">
<h2>Deductive vs.&nbsp;inductive approaches</h2>
<ul>
<li><p>In the previous lecture, we talked about deductive approaches (such as dictionary approaches)</p></li>
<li><p>These are <strong>deterministic</strong> and are based on a priori text theory (e.g., happy -&gt; positive, hate -&gt; negative)</p></li>
<li><p>Yet, natural language is often ambiguous and a <strong>probabilistic</strong> coding may be better</p></li>
<li><p>Dictionary-based or generally rule-based approaches are not very similar to manual coding; a human being assesses much more than just a list of words</p></li>
<li><p>Inductive approaches promise to combine the scalability of automatic coding with the validity of manual coding (<strong>supervised learning</strong>) or can even identify things or relations that we as human beings cannot identify (<strong>unsupervised learning</strong>)</p></li>
</ul>
</section>
<section class="slide level2">


<img data-src="img/machinelearning.png" class="r-stretch"></section>
<section id="example-of-supervised-text-classification" class="slide level2">
<h2>Example of supervised text classification</h2>
<center>
<img data-src="img/ml_newspaper_example.png">
</center>
</section>
<section id="general-text-classification-pipeline" class="slide level2">
<h2>General text classification pipeline</h2>

<img data-src="img/text_analysis_fundamentals/Slide01.png" class="r-stretch"></section>
<section id="supervised-text-classification-pipeline" class="slide level2">
<h2>Supervised Text Classification Pipeline</h2>

<img data-src="img/text_analysis_fundamentals/Slide03.png" class="r-stretch"></section>
<section id="basic-idea-of-machine-learning-algorithms" class="slide level2">
<h2>Basic idea of Machine Learning Algorithms</h2>
<ul>
<li><p>The general goal, however, is always the same: Model the relationship between…</p>
<ul>
<li>Input features
<ul>
<li>Similar to independent variables in statistics</li>
<li>Can be MANY features (e.g., all words in a corpus)</li>
</ul></li>
<li>Output class
<ul>
<li>Similar to dependent variables</li>
<li>Can be categories or continuous</li>
</ul></li>
</ul></li>
</ul>

<img data-src="img/algorithm_scheme.png" class="r-stretch"></section>
<section id="statistical-modeling-vs.-supervised-machine-learning" class="slide level2">
<h2>Statistical modeling vs.&nbsp;Supervised Machine learning</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>Machine learning, many people joke, is nothing other than a fancy name for statistics.</p></li>
<li><p>There is some truth to this: if you say “logistic regression”, this will sound familiar to both statisticians and machine learning practitioners.</p></li>
<li><p>Still, there are some differences between traditional statistical approaches and the machine learning approach, even if some of the same mathematical tools are used.</p></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="https://i.stack.imgur.com/7U552.png"></p>
<p></p><figcaption>Source: Demetri Pananos/stackoverflow</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="statistical-modeling" class="slide level2">
<h2>Statistical Modeling</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>Statistical modeling is about understanding the relationship between one (or several predictors) and an outcom variable</p></li>
<li><p>Learn <span class="math inline">\(f\)</span> so you can predict <span class="math inline">\(y\)</span> from <span class="math inline">\(x\)</span>:</p></li>
</ul>
<center>
<span class="math inline">\(y = f(x)\)</span>
</center>
<ul>
<li>In a linear regression model, we aim to find the best fitting “line” that best predicts <code>y</code> based on <code>x</code>:</li>
</ul>
<center>
<span class="math inline">\(y = -0.16 + 2.31 * x + \epsilon\)</span>
</center>
<ul>
<li>In a typical communication science paper, we would say something like: when <code>x</code> increases by one unit,<code>y</code> increases by 2.31 units.</li>
</ul>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:45%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="03_classicmachinelearning_2023_files/figure-revealjs/unnamed-chunk-1-1.png" width="480"></p>
</div>
</div>
</div>
</div>
</section>
<section id="machine-learning" class="slide level2">
<h2>Machine Learning</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>Machine learning is less about understanding the relationship, but about maximizing prediction.</p></li>
<li><p>A statistical model such as the one estimated can be used to predict most likely <code>y</code> values based on new <code>x</code> data.</p></li>
<li><p>For example, despite not being in the data, <code>x = -1</code> should be <code>y = -2.47</code>; <code>x = 5</code> should be <code>y = 11.41</code> based on the fitted line!</p></li>
<li><p>In other words, machine learnings doesn’t focus on explanation, but emphasizes prediction.</p></li>
</ul>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:45%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="03_classicmachinelearning_2023_files/figure-revealjs/unnamed-chunk-2-1.png" width="480"></p>
</div>
</div>
</div>
</div>
</section>
<section id="differences-in-language" class="slide level2">
<h2>Differences in language</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/lingo.png" style="width:75.0%"></p>
<p></p><figcaption>Source: van Atteveldt et al., 2021</figcaption><p></p>
</figure>
</div>
</center>
</section>
<section id="differences-in-goals" class="slide level2">
<h2>Differences in Goals</h2>
<ul>
<li><p>Goal of statistical modeling: explaining/understanding</p>
<ul>
<li>Serves to make inferences about a population (“Does X relate to Y?”)</li>
<li>Doesn’t use too many variables to avoid the difficulty of interpreting too many parameters</li>
<li>Requires interpretable parameters</li>
</ul></li>
<li><p>Goal of machine learning: best possible prediction</p>
<ul>
<li>make generalizable predictions (“How to best predict Y?”)</li>
<li>We do not care about the actual values of the coefficients, we just need them for our prediction.</li>
<li>In fact, in many machine learning models, we will have so many of them that we do not even bother to report them.</li>
</ul></li>
</ul>
<div class="fragment">
<p><strong>Note:</strong> Machine learning models often have 1000’s of collinear independent variables and can have many latent variables!</p>
</div>
</section>
<section id="over--vs.-underfit" class="slide level2">
<h2>Over- vs.&nbsp;underfit</h2>
<ul>
<li><p>Problem in Machine Learning: Sufficiently complex algorithms can “predict” all training data perfectly</p></li>
<li><p>But such an algorithm does not generalize to new data (the actual goal!)</p></li>
<li><p>Essentially, we want the model to have a good fit to the data, but we also want it to not optimize on things that are specific to the training data set</p></li>
<li><p>Problem of under- vs- overfit</p></li>
</ul>
</section>
<section id="examplifying-over--and-underfit" class="slide level2">
<h2>Examplifying over- and underfit</h2>

<img data-src="03_classicmachinelearning_2023_files/figure-revealjs/unnamed-chunk-3-1.png" width="960" class="r-stretch"></section>
<section id="linear-fit-underfit" class="slide level2">
<h2>Linear fit (underfit)</h2>

<img data-src="03_classicmachinelearning_2023_files/figure-revealjs/unnamed-chunk-4-1.png" width="960" class="r-stretch"></section>
<section id="overfit" class="slide level2">
<h2>Overfit</h2>

<img data-src="03_classicmachinelearning_2023_files/figure-revealjs/unnamed-chunk-5-1.png" width="960" class="r-stretch"></section>
<section id="good-fit" class="slide level2">
<h2>Good fit</h2>

<img data-src="03_classicmachinelearning_2023_files/figure-revealjs/unnamed-chunk-6-1.png" width="960" class="r-stretch"></section>
<section id="preventing-overfitting" class="slide level2">
<h2>Preventing overfitting</h2>
<ul>
<li><p>Regularization during fitting process</p>
<ul>
<li>‘Punish’ complexity</li>
<li>Constrain flexibility</li>
<li>Removing noise</li>
</ul></li>
<li><p>Out-of-sample validation</p>
<ul>
<li>To see whether a model generalizes to new data, simply test it on new data</li>
<li>This validation set clearly detects overfitting</li>
</ul></li>
<li><p>In sum, we need to validate our new classifier on unseen data</p></li>
</ul>
</section>
<section id="solution-training-and-testing" class="slide level2">
<h2>Solution: Training and Testing</h2>
<ul>
<li><p>As models (almost) always overfit, it is clear that performance on only training data is not a good indicator of the real quality of the classifier</p></li>
<li><p>The standard solution is to split the labeled data into a training and test data sets: This way, we can train the algorithm on one part and then evaluate its validity / performance on the held-out part of the data.</p></li>
<li><p>We prevent overfit if the classifier still perform well on unseen data and not just on the training data!</p></li>
</ul>
</section>
<section id="integrating-testing-in-the-pipeline" class="slide level2">
<h2>Integrating testing in the pipeline</h2>

<img data-src="img/testing_training.png" class="r-stretch"></section>
<section id="testing-validation" class="slide level2">
<h2>Testing = Validation</h2>
<div class="columns">
<div class="column" style="width:70%;">
<ul>
<li><p>Remember how we validated dictionary approaches?</p>
<ul>
<li>We manually coded a small set of the text</li>
<li>Compared this gold standard to the dictionary result</li>
</ul></li>
<li><p>In supervised text classification, the procedure is similar</p>
<ul>
<li>We use the classifier (trained on the training data) to predict the outcome in the test data</li>
<li>Because the test data is only a subset of our labeled data, it also contains the true outcome</li>
<li>We can compare the predicted with the actual outcome and compute the same performance scores (Accuracy, Precision,…)</li>
</ul></li>
</ul>
</div><div class="column" style="width:30%;">
<p><img data-src="img/validation_ml.png"></p>
</div>
</div>
</section>
<section id="a-small-note-on-dealing-with-non-determinism" class="slide level2">
<h2>A Small Note on Dealing with non-determinism</h2>
<ul>
<li><p>Many aspects of machine learning are non-deterministic, i.e., there is a certain randomness in the procedure</p>
<ul>
<li>Randomly splitting the available labeled data into training and test sets</li>
<li>Some algorithms start from random initial states (e.g., drawing a random number)</li>
</ul></li>
<li><p>Problem: Research thereby becomes not replicable and the outcome may be affected</p></li>
<li><p>To ensure replicability</p>
<ul>
<li>We can set a so-called random seed in R with <code>set.seed(123)</code></li>
<li>This way, we force R to use the exact same procedure (even when we repeat it)</li>
</ul></li>
<li><p>For valid outcome:</p>
<ul>
<li>Repeat the procedure X times</li>
<li>Report average performance</li>
</ul></li>
</ul>
</section>
<section id="example-predicting-music-genre-from-lyrics" class="slide level2">
<h2>Example: Predicting music genre from lyrics</h2>
<ul>
<li><p>For the remainder of this lecture, I will exemplify different approaches to supervised text classification using a data set that contains song lyrics and the genre of the artist.</p></li>
<li><p>The goal is to investigate whether we can train an algorithm sufficiently well to predict the genre from only song lyrics.</p></li>
</ul>
<div class="cell" data-r.options="{&quot;width&quot;:120}">
<div class="sourceCode cell-code" id="cb1" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co"># Set seed</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co"># Read data</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>lyrics_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/lyrics-data-prep.csv"</span>) <span class="sc">|&gt;</span>               </span>
<span id="cb1-8"><a href="#cb1-8"></a>  <span class="fu">mutate</span>(<span class="at">binary_genre =</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(Genre <span class="sc">==</span><span class="st">"Rock"</span>,<span class="st">"rock"</span>, <span class="st">"other"</span>),  <span class="co"># &lt;-- create binary outcome </span></span>
<span id="cb1-9"><a href="#cb1-9"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"rock"</span>, <span class="st">"other"</span>) )) <span class="sc">|&gt;</span>        <span class="co"># &lt;-- order categories!</span></span>
<span id="cb1-10"><a href="#cb1-10"></a>  <span class="fu">sample_frac</span>(<span class="at">size =</span> .<span class="dv">20</span>) <span class="sc">|&gt;</span>                                            <span class="co"># &lt;-- Sample 20% of the data</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>  <span class="fu">select</span>(<span class="at">doc_id =</span> SLink, Artist, <span class="at">Song =</span> SName, </span>
<span id="cb1-12"><a href="#cb1-12"></a>         Genre, binary_genre, <span class="at">text =</span> Lyric)</span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="fu">head</span>(lyrics_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment" data-r.options="{&quot;width&quot;:120}">
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource output number-lines code-with-copy"><code class="sourceCode"><span id="cb2-1"><a href="#cb2-1"></a># A tibble: 6 × 6</span>
<span id="cb2-2"><a href="#cb2-2"></a>  doc_id                                     Artist            Song                             Genre binary_genre text </span>
<span id="cb2-3"><a href="#cb2-3"></a>  &lt;chr&gt;                                      &lt;chr&gt;             &lt;chr&gt;                            &lt;chr&gt; &lt;fct&gt;        &lt;chr&gt;</span>
<span id="cb2-4"><a href="#cb2-4"></a>1 /snoop-dogg/213-tha-gangsta-clicc.html     Snoop Dogg        213 Tha Gangsta Clicc            Hip … other        "[Sn…</span>
<span id="cb2-5"><a href="#cb2-5"></a>2 /far-east-movement/jello-feat-rye-rye.html Far East Movement Jello (feat. Rye Rye)            Pop   other        "Jel…</span>
<span id="cb2-6"><a href="#cb2-6"></a>3 /janet-jackson/got-till-its-gone.html      Janet Jackson     Got 'til It's Gone (feat. Q-Tip… Pop   other        "Wha…</span>
<span id="cb2-7"><a href="#cb2-7"></a>4 /tori-amos/yo-george.html                  Tori Amos         Yo George                        Rock  rock         "I s…</span>
<span id="cb2-8"><a href="#cb2-8"></a>5 /van-morrison/a-sense-of-wonder.html       Van Morrison      A Sense of Wonder                Rock  rock         "I w…</span>
<span id="cb2-9"><a href="#cb2-9"></a>6 /heart/together-now.html                   Heart             Together Now                     Rock  rock         "Dee…</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="the-data-set" class="slide level2">
<h2>The data set</h2>
<div class="columns">
<div class="column" style="width:45%;">
<ul>
<li><p>This data is scraped from the “Vagalume” website, so it depends on their storing and sharing millions of song lyrics (not really representative or complete)</p></li>
<li><p>Contains artist name, song name, lyrics, and genre of the artist (not the song)</p></li>
<li><p>The following genres are in this subsample of the data set:</p>
<ul>
<li>Rock</li>
<li>Hip Hop</li>
<li>Pop Music</li>
</ul></li>
</ul>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:45%;">
<div class="cell" data-output-location="fragment">
<div class="sourceCode cell-code" id="cb3" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>lyrics_data <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="fu">group_by</span>(Genre) <span class="sc">|&gt;</span>  </span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="fu">tally</span>() <span class="sc">|&gt;</span> </span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Genre, n), <span class="at">y =</span> n, </span>
<span id="cb3-5"><a href="#cb3-5"></a>             <span class="at">fill =</span> Genre)) <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>) <span class="sc">+</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>  ggridges<span class="sc">::</span><span class="fu">theme_ridges</span>() <span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> F) <span class="sc">+</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb3-12"><a href="#cb3-12"></a>       <span class="at">y =</span> <span class="st">"Number of Songs"</span>, </span>
<span id="cb3-13"><a href="#cb3-13"></a>       <span class="at">title =</span> <span class="st">"Songs per Genre"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="03_classicmachinelearning_2023_files/figure-revealjs/unnamed-chunk-8-1.png" width="441"></p>
</div>
</div>
</div>
</div>
</section>
<section id="lets-check-out-a-song" class="slide level2">
<h2>Let’s check out a song</h2>
<div class="columns">
<div class="column" style="width:80%;">
<div class="cell" data-r.options="{&quot;width&quot;:120}">
<div class="sourceCode cell-code" id="cb4" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb4-2"><a href="#cb4-2"></a>lyrics_data <span class="sc">|&gt;</span> </span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="fu">filter</span>(Artist <span class="sc">==</span> <span class="st">"Radiohead"</span> <span class="sc">&amp;</span> Song <span class="sc">==</span> <span class="st">"Paranoid Android"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="fu">unnest_tokens</span>(lines, text, <span class="at">token =</span> <span class="st">"sentences"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="fu">select</span>(lines) <span class="sc">|&gt;</span> </span>
<span id="cb4-6"><a href="#cb4-6"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource output number-lines code-with-copy"><code class="sourceCode"><span id="cb5-1"><a href="#cb5-1"></a># A tibble: 39 × 1</span>
<span id="cb5-2"><a href="#cb5-2"></a>   lines                                                        </span>
<span id="cb5-3"><a href="#cb5-3"></a>   &lt;chr&gt;                                                        </span>
<span id="cb5-4"><a href="#cb5-4"></a> 1 please could you stop the noise, i'm trying to get some rest.</span>
<span id="cb5-5"><a href="#cb5-5"></a> 2 from all the unborn chicken voices in my head.               </span>
<span id="cb5-6"><a href="#cb5-6"></a> 3 what's this...?                                              </span>
<span id="cb5-7"><a href="#cb5-7"></a> 4 (i may be paranoid, but not an android).                     </span>
<span id="cb5-8"><a href="#cb5-8"></a> 5 what's this...?                                              </span>
<span id="cb5-9"><a href="#cb5-9"></a> 6 (i may be paranoid, but not an android).                     </span>
<span id="cb5-10"><a href="#cb5-10"></a> 7 when i am king, you will be first against the wall.          </span>
<span id="cb5-11"><a href="#cb5-11"></a> 8 with your opinion which is of no consequence at all.         </span>
<span id="cb5-12"><a href="#cb5-12"></a> 9 what's this...?                                              </span>
<span id="cb5-13"><a href="#cb5-13"></a>10 (i may be paranoid, but no android).                         </span>
<span id="cb5-14"><a href="#cb5-14"></a>11 what's this...?                                              </span>
<span id="cb5-15"><a href="#cb5-15"></a>12 (i may be paranoid, but no android).                         </span>
<span id="cb5-16"><a href="#cb5-16"></a>13 ambition makes you look pretty ugly.                         </span>
<span id="cb5-17"><a href="#cb5-17"></a>14 kicking and squealing gucci little piggy.                    </span>
<span id="cb5-18"><a href="#cb5-18"></a>15 you don't remember.                                          </span>
<span id="cb5-19"><a href="#cb5-19"></a>16 you don't remember.                                          </span>
<span id="cb5-20"><a href="#cb5-20"></a>17 why don't you remember my name?.                             </span>
<span id="cb5-21"><a href="#cb5-21"></a>18 off with his head, man.                                      </span>
<span id="cb5-22"><a href="#cb5-22"></a>19 off with his head, man.                                      </span>
<span id="cb5-23"><a href="#cb5-23"></a>20 why don't you remember my name?.                             </span>
<span id="cb5-24"><a href="#cb5-24"></a># ℹ 19 more rows</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:18%;">
<p><img data-src="https://upload.wikimedia.org/wikipedia/en/b/ba/Radioheadokcomputer.png"></p>
</div>
</div>
</section>
<section id="splitting-the-data-into-a-train-and-a-test-set" class="slide level2">
<h2>Splitting the data into a train and a test set</h2>
<div class="columns">
<div class="column" style="width:60%&quot;;">
<ul>
<li><p>There are different way to think about creating a test vs.&nbsp;training data set</p></li>
<li><p>Simplest form: split-half (or any other percentage distribution)</p></li>
<li><p>But there are also other, more complex procedures that fall under the term “cross-validation”</p>
<ul>
<li>Leave-1-out</li>
<li>k-fold</li>
</ul></li>
<li><p>What approach is meaningful depends on the question and goal!</p></li>
</ul>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:35%;">
<p><br></p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c7/LOOCV.gif/600px-LOOCV.gif"></p>
<p></p><figcaption>Leave-1-out cross validation</figcaption><p></p>
</figure>
</div>
<p><br><br></p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4b/KfoldCV.gif/700px-KfoldCV.gif"></p>
<p></p><figcaption>k-fold cross validation</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="splitting-the-data-set-in-r" class="slide level2">
<h2>Splitting the data set in R</h2>
<ul>
<li><p>For the entire model fitting process, we are going to use the package <code>tidymodels</code>, which nicely intersects with the already known package <code>tidytext</code></p></li>
<li><p>Here, we can use the functions <code>initial_split</code> to split our data set. The functions <code>training</code> and <code>testing</code> create the actual data sets from the splits.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co"># Set seed to insure replicability</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb6-5"><a href="#cb6-5"></a></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co"># Create initial split proporations</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(lyrics_data, <span class="at">prop =</span> .<span class="dv">60</span>)</span>
<span id="cb6-8"><a href="#cb6-8"></a></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="co"># Create training and test data</span></span>
<span id="cb6-10"><a href="#cb6-10"></a>train_data <span class="ot">&lt;-</span> <span class="fu">training</span>(split)</span>
<span id="cb6-11"><a href="#cb6-11"></a>test_data <span class="ot">&lt;-</span> <span class="fu">testing</span>(split)</span>
<span id="cb6-12"><a href="#cb6-12"></a></span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="co"># Check</span></span>
<span id="cb6-14"><a href="#cb6-14"></a><span class="fu">tibble</span>(<span class="at">dataset =</span> <span class="fu">c</span>(<span class="st">"training"</span>, <span class="st">"testing"</span>),</span>
<span id="cb6-15"><a href="#cb6-15"></a>       <span class="at">n_songs =</span> <span class="fu">c</span>(<span class="fu">nrow</span>(train_data), <span class="fu">nrow</span>(test_data)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource output number-lines code-with-copy"><code class="sourceCode"><span id="cb7-1"><a href="#cb7-1"></a># A tibble: 2 × 2</span>
<span id="cb7-2"><a href="#cb7-2"></a>  dataset  n_songs</span>
<span id="cb7-3"><a href="#cb7-3"></a>  &lt;chr&gt;      &lt;int&gt;</span>
<span id="cb7-4"><a href="#cb7-4"></a>1 training   10445</span>
<span id="cb7-5"><a href="#cb7-5"></a>2 testing     6964</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section></section>
<section>
<section id="algorithms-for-supervised-text-classification" class="title-slide slide level1 center" data-background-color="steelblue">
<h1>Algorithms for Supervised text classification</h1>
<p>From Logistic Regression to Neural Networks.</p>
</section>
<section id="feature-engineering" class="slide level2">
<h2>Feature Engineering</h2>
<ul>
<li><p>Classic machine learning models require a numerical representation of text (e.g., document-feature matrix)</p></li>
<li><p>They further need the outcome variable that they should predict</p></li>
<li><p>All text-preprocessing steps (e.g., stopword removal, stemming, lemmatization, frequency trimming, weighting, etc.) may change the performance, but no clear rules on what works and what does not</p></li>
<li><p>Only solution: Trial and error!</p></li>
</ul>
</section>
<section id="text-preprocessing-with-tidytext" class="slide level2">
<h2>Text Preprocessing with TidyText</h2>
<div class="cell" data-r.options="{&quot;width&quot;:120}">
<div class="sourceCode cell-code" id="cb8" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb8-2"><a href="#cb8-2"></a></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co"># Text Preprocessing</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>dfm_train <span class="ot">&lt;-</span> train_data <span class="sc">|&gt;</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>  <span class="fu">unnest_tokens</span>(word, text) <span class="sc">|&gt;</span> </span>
<span id="cb8-6"><a href="#cb8-6"></a>  <span class="fu">anti_join</span>(stop_words) <span class="sc">|&gt;</span> </span>
<span id="cb8-7"><a href="#cb8-7"></a>  <span class="fu">group_by</span>(doc_id, word) <span class="sc">|&gt;</span> </span>
<span id="cb8-8"><a href="#cb8-8"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb8-9"><a href="#cb8-9"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> word, <span class="at">values_from =</span> n, <span class="at">values_fill =</span> <span class="dv">0</span>)</span>
<span id="cb8-10"><a href="#cb8-10"></a></span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="co"># Check</span></span>
<span id="cb8-12"><a href="#cb8-12"></a>dfm_train <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource output number-lines code-with-copy"><code class="sourceCode"><span id="cb9-1"><a href="#cb9-1"></a># A tibble: 6 × 43,613</span>
<span id="cb9-2"><a href="#cb9-2"></a># Groups:   doc_id [6]</span>
<span id="cb9-3"><a href="#cb9-3"></a>  doc_id  answer blowing breeze brick burning candle changed close color considered distant earth fading fingers flowers</span>
<span id="cb9-4"><a href="#cb9-4"></a>  &lt;chr&gt;    &lt;int&gt;   &lt;int&gt;  &lt;int&gt; &lt;int&gt;   &lt;int&gt;  &lt;int&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;      &lt;int&gt;   &lt;int&gt; &lt;int&gt;  &lt;int&gt;   &lt;int&gt;   &lt;int&gt;</span>
<span id="cb9-5"><a href="#cb9-5"></a>1 /10000…      2       1      1     1       1      1       1     2     1          1       1     1      1       1       1</span>
<span id="cb9-6"><a href="#cb9-6"></a>2 /10000…      0       0      0     0       0      0       0     0     0          0       0     0      2       0       0</span>
<span id="cb9-7"><a href="#cb9-7"></a>3 /10000…      0       0      0     0       0      0       0     0     0          0       0     0      0       0       0</span>
<span id="cb9-8"><a href="#cb9-8"></a>4 /10000…      0       0      0     0       0      0       0     0     0          0       0     0      0       0       0</span>
<span id="cb9-9"><a href="#cb9-9"></a>5 /10000…      0       0      0     0       0      0       0     2     0          0       0     0      0       0       0</span>
<span id="cb9-10"><a href="#cb9-10"></a>6 /10000…      0       0      0     0       0      0       0     0     0          0       0     0      0       0       0</span>
<span id="cb9-11"><a href="#cb9-11"></a># ℹ 43,597 more variables: forever &lt;int&gt;, frozen &lt;int&gt;, funny &lt;int&gt;, glass &lt;int&gt;, grey &lt;int&gt;, hold &lt;int&gt;, home &lt;int&gt;,</span>
<span id="cb9-12"><a href="#cb9-12"></a>#   lane &lt;int&gt;, liquid &lt;int&gt;, live &lt;int&gt;, looked &lt;int&gt;, love &lt;int&gt;, melding &lt;int&gt;, memories &lt;int&gt;, overturned &lt;int&gt;,</span>
<span id="cb9-13"><a href="#cb9-13"></a>#   past &lt;int&gt;, planting &lt;int&gt;, questions &lt;int&gt;, raw &lt;int&gt;, remember &lt;int&gt;, safe &lt;int&gt;, seldom &lt;int&gt;, shuddered &lt;int&gt;,</span>
<span id="cb9-14"><a href="#cb9-14"></a>#   silent &lt;int&gt;, sleep &lt;int&gt;, slip &lt;int&gt;, slowly &lt;int&gt;, smile &lt;int&gt;, summer &lt;int&gt;, surface &lt;int&gt;, tend &lt;int&gt;,</span>
<span id="cb9-15"><a href="#cb9-15"></a>#   threw &lt;int&gt;, vision &lt;int&gt;, walks &lt;int&gt;, weary &lt;int&gt;, whisper &lt;int&gt;, world &lt;int&gt;, `10,000` &lt;int&gt;, australian &lt;int&gt;,</span>
<span id="cb9-16"><a href="#cb9-16"></a>#   blue &lt;int&gt;, calling &lt;int&gt;, calls &lt;int&gt;, cds &lt;int&gt;, choice &lt;int&gt;, choose &lt;int&gt;, cold &lt;int&gt;, days &lt;int&gt;,</span>
<span id="cb9-17"><a href="#cb9-17"></a>#   deserting &lt;int&gt;, euro &lt;int&gt;, feelings &lt;int&gt;, hear &lt;int&gt;, hero &lt;int&gt;, left &lt;int&gt;, maniacs &lt;int&gt;, moment &lt;int&gt;, …</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="alternative-in-tidymodels-creating-a-recipe" class="slide level2">
<h2>Alternative in tidymodels: Creating A “Recipe”</h2>
<div class="cell" data-r.options="{&quot;width&quot;:120}">
<div class="sourceCode cell-code" id="cb10" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="fu">library</span>(textrecipes)</span>
<span id="cb10-2"><a href="#cb10-2"></a></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="co"># Create recipe for text preprocessing</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(binary_genre <span class="sc">~</span> text, <span class="at">data =</span> lyrics_data) <span class="sc">|&gt;</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>  <span class="fu">step_tokenize</span>(text, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">strip_punct =</span> T, <span class="at">strip_numeric =</span> T)) <span class="sc">|&gt;</span>  </span>
<span id="cb10-6"><a href="#cb10-6"></a>  <span class="fu">step_stopwords</span>(text, <span class="at">language =</span> <span class="st">"en"</span>) <span class="sc">|&gt;</span>    </span>
<span id="cb10-7"><a href="#cb10-7"></a>  <span class="fu">step_tokenfilter</span>(text, <span class="at">min_times =</span> <span class="dv">20</span>, <span class="at">max_tokens =</span> <span class="dv">1000</span> ) <span class="sc">|&gt;</span> </span>
<span id="cb10-8"><a href="#cb10-8"></a>  <span class="fu">step_tf</span>(<span class="fu">all_predictors</span>()) </span>
<span id="cb10-9"><a href="#cb10-9"></a></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co"># "Bake" (check) based on recipe to see text preprocessing</span></span>
<span id="cb10-11"><a href="#cb10-11"></a>rec <span class="sc">|&gt;</span> </span>
<span id="cb10-12"><a href="#cb10-12"></a>  <span class="fu">prep</span>(train_data) <span class="sc">|&gt;</span></span>
<span id="cb10-13"><a href="#cb10-13"></a>  <span class="fu">bake</span>(<span class="at">new_data=</span><span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb11"><pre class="sourceCode numberSource output number-lines code-with-copy"><code class="sourceCode"><span id="cb11-1"><a href="#cb11-1"></a># A tibble: 10,445 × 1,001</span>
<span id="cb11-2"><a href="#cb11-2"></a>   binary_genre tf_text_2x tf_text_across tf_text_act tf_text_afraid tf_text_ah tf_text_ahead `tf_text_ain't`</span>
<span id="cb11-3"><a href="#cb11-3"></a>   &lt;fct&gt;             &lt;int&gt;          &lt;int&gt;       &lt;int&gt;          &lt;int&gt;      &lt;int&gt;         &lt;int&gt;           &lt;int&gt;</span>
<span id="cb11-4"><a href="#cb11-4"></a> 1 rock                  0              0           0              0          0             0               0</span>
<span id="cb11-5"><a href="#cb11-5"></a> 2 other                 0              0           0              0          0             0               0</span>
<span id="cb11-6"><a href="#cb11-6"></a> 3 other                 0              0           0              0          0             0               0</span>
<span id="cb11-7"><a href="#cb11-7"></a> 4 rock                  0              0           0              0          0             0               0</span>
<span id="cb11-8"><a href="#cb11-8"></a> 5 other                 0              0           0              0          0             0               2</span>
<span id="cb11-9"><a href="#cb11-9"></a> 6 rock                  0              0           0              0          0             0               2</span>
<span id="cb11-10"><a href="#cb11-10"></a> 7 other                 0              0           1              0          0             0               1</span>
<span id="cb11-11"><a href="#cb11-11"></a> 8 rock                  0              1           0              0          0             0               0</span>
<span id="cb11-12"><a href="#cb11-12"></a> 9 other                 0              0           0              0          0             0               0</span>
<span id="cb11-13"><a href="#cb11-13"></a>10 rock                  0              0           0              1          0             0               1</span>
<span id="cb11-14"><a href="#cb11-14"></a># ℹ 10,435 more rows</span>
<span id="cb11-15"><a href="#cb11-15"></a># ℹ 993 more variables: tf_text_aint &lt;int&gt;, tf_text_air &lt;int&gt;, tf_text_alive &lt;int&gt;, tf_text_almost &lt;int&gt;,</span>
<span id="cb11-16"><a href="#cb11-16"></a>#   tf_text_alone &lt;int&gt;, tf_text_along &lt;int&gt;, tf_text_already &lt;int&gt;, tf_text_alright &lt;int&gt;, tf_text_always &lt;int&gt;,</span>
<span id="cb11-17"><a href="#cb11-17"></a>#   tf_text_angel &lt;int&gt;, tf_text_angels &lt;int&gt;, tf_text_another &lt;int&gt;, tf_text_answer &lt;int&gt;, tf_text_anybody &lt;int&gt;,</span>
<span id="cb11-18"><a href="#cb11-18"></a>#   tf_text_anymore &lt;int&gt;, tf_text_anyone &lt;int&gt;, tf_text_anything &lt;int&gt;, tf_text_anyway &lt;int&gt;, tf_text_apart &lt;int&gt;,</span>
<span id="cb11-19"><a href="#cb11-19"></a>#   tf_text_arms &lt;int&gt;, tf_text_around &lt;int&gt;, tf_text_ask &lt;int&gt;, tf_text_asking &lt;int&gt;, tf_text_ass &lt;int&gt;,</span>
<span id="cb11-20"><a href="#cb11-20"></a>#   tf_text_awake &lt;int&gt;, tf_text_away &lt;int&gt;, tf_text_ay &lt;int&gt;, tf_text_b &lt;int&gt;, tf_text_ba &lt;int&gt;, tf_text_babe &lt;int&gt;, …</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="workflow-in-tidymodels" class="slide level2">
<h2>Workflow in Tidymodels</h2>
<div class="columns">
<div class="column" style="width:70%;">
<ul>
<li><p>The collection <code>tidymodels</code> contains a variety of packages that facilitates and streamlines machine learning in R</p></li>
<li><p>The basic procedure is the following:</p>
<ol type="1">
<li>Create a <strong>recipe</strong> (this includes already a formula and all pre-processing steps)</li>
<li><strong>Bake</strong> training and testing data using the <strong>recipe</strong> (not explicitly necesssary)</li>
<li>Create a designated <strong>model function</strong> (depending on what type of algorithm should be used)</li>
<li>Bind all together using a <strong>workflow</strong></li>
<li>Fit the entire <strong>workflow</strong> and evaluate performance</li>
</ol></li>
</ul>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:28%;">
<p><img data-src="https://rviews.rstudio.com/2020/04/21/the-case-for-tidymodels/tidymodels.png"></p>
</div>
</div>
</section>
<section id="setting-up-a-recipe-for-our-example" class="slide level2">
<h2>Setting up a recipe for our example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># Load specific support library</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="fu">library</span>(textrecipes)</span>
<span id="cb12-3"><a href="#cb12-3"></a></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="co"># Create recipe</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(binary_genre <span class="sc">~</span> text, <span class="at">data =</span> lyrics_data)                 <span class="co"># &lt;-- predict binary_genre by text</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="setting-up-a-recipe-for-our-example-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Setting up a recipe for our example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb13-1" class="hljs-ln-code"><a href="#cb13-1"></a><span class="co"># Load specific support library</span></span>
<span id="cb13-2" class="hljs-ln-code"><a href="#cb13-2"></a><span class="fu">library</span>(textrecipes)</span>
<span id="cb13-3" class="hljs-ln-code"><a href="#cb13-3"></a></span>
<span id="cb13-4" class="hljs-ln-code"><a href="#cb13-4"></a><span class="co"># Create recipe</span></span>
<span id="cb13-5" class="hljs-ln-code"><a href="#cb13-5"></a>rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(binary_genre <span class="sc">~</span> text, <span class="at">data =</span> lyrics_data) <span class="sc">|&gt;</span>              <span class="co"># &lt;-- predict binary_genre by text</span></span>
<span id="cb13-6" class="hljs-ln-code"><a href="#cb13-6"></a>  <span class="fu">step_tokenize</span>(text, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">strip_punct =</span> T,                  <span class="co"># &lt;-- tokenize, remove punctuation</span></span>
<span id="cb13-7" class="hljs-ln-code"><a href="#cb13-7"></a>                                     <span class="at">strip_numeric =</span> T))               <span class="co"># &lt;-- remove numbers</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="setting-up-a-recipe-for-our-example-2" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Setting up a recipe for our example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb14-1" class="hljs-ln-code"><a href="#cb14-1"></a><span class="co"># Load specific support library</span></span>
<span id="cb14-2" class="hljs-ln-code"><a href="#cb14-2"></a><span class="fu">library</span>(textrecipes)</span>
<span id="cb14-3" class="hljs-ln-code"><a href="#cb14-3"></a></span>
<span id="cb14-4" class="hljs-ln-code"><a href="#cb14-4"></a><span class="co"># Create recipe</span></span>
<span id="cb14-5" class="hljs-ln-code"><a href="#cb14-5"></a>rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(binary_genre <span class="sc">~</span> text, <span class="at">data =</span> lyrics_data) <span class="sc">|&gt;</span>              <span class="co"># &lt;-- predict binary_genre by text</span></span>
<span id="cb14-6" class="hljs-ln-code"><a href="#cb14-6"></a>  <span class="fu">step_tokenize</span>(text, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">strip_punct =</span> T,                  <span class="co"># &lt;-- tokenize, remove punctuation</span></span>
<span id="cb14-7" class="hljs-ln-code"><a href="#cb14-7"></a>                                     <span class="at">strip_numeric =</span> T)) <span class="sc">|&gt;</span>            <span class="co"># &lt;-- remove numbers</span></span>
<span id="cb14-8" class="hljs-ln-code"><a href="#cb14-8"></a>  <span class="fu">step_stopwords</span>(text, <span class="at">language =</span> <span class="st">"en"</span>) <span class="sc">|&gt;</span>                             <span class="co"># &lt;-- remove stopwords                 </span></span>
<span id="cb14-9" class="hljs-ln-code"><a href="#cb14-9"></a>  <span class="fu">step_tokenfilter</span>(text, <span class="at">min_times =</span> <span class="dv">20</span>, <span class="at">max_tokens =</span> <span class="dv">1000</span>)            <span class="co"># &lt;-- filter out rare words and use only top 1000                         </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="setting-up-a-recipe-for-our-example-3" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Setting up a recipe for our example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb15-1" class="hljs-ln-code"><a href="#cb15-1"></a><span class="co"># Load specific support library</span></span>
<span id="cb15-2" class="hljs-ln-code"><a href="#cb15-2"></a><span class="fu">library</span>(textrecipes)</span>
<span id="cb15-3" class="hljs-ln-code"><a href="#cb15-3"></a></span>
<span id="cb15-4" class="hljs-ln-code"><a href="#cb15-4"></a><span class="co"># Create recipe</span></span>
<span id="cb15-5" class="hljs-ln-code"><a href="#cb15-5"></a>rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(binary_genre <span class="sc">~</span> text, <span class="at">data =</span> lyrics_data) <span class="sc">|&gt;</span>              <span class="co"># &lt;-- predict binary_genre by text</span></span>
<span id="cb15-6" class="hljs-ln-code"><a href="#cb15-6"></a>  <span class="fu">step_tokenize</span>(text, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">strip_punct =</span> T,                  <span class="co"># &lt;-- tokenize, remove punctuation</span></span>
<span id="cb15-7" class="hljs-ln-code"><a href="#cb15-7"></a>                                     <span class="at">strip_numeric =</span> T)) <span class="sc">|&gt;</span>            <span class="co"># &lt;-- remove numbers</span></span>
<span id="cb15-8" class="hljs-ln-code"><a href="#cb15-8"></a>  <span class="fu">step_stopwords</span>(text, <span class="at">language =</span> <span class="st">"en"</span>) <span class="sc">|&gt;</span>                             <span class="co"># &lt;-- remove stopwords                 </span></span>
<span id="cb15-9" class="hljs-ln-code"><a href="#cb15-9"></a>  <span class="fu">step_tokenfilter</span>(text, <span class="at">min_times =</span> <span class="dv">20</span>, <span class="at">max_tokens =</span> <span class="dv">1000</span>) <span class="sc">|&gt;</span>         <span class="co"># &lt;-- filter out rare words and use only top 1000              </span></span>
<span id="cb15-10" class="hljs-ln-code"><a href="#cb15-10"></a>  <span class="fu">step_tf</span>(<span class="fu">all_predictors</span>())                                            <span class="co"># &lt;-- create document-feature matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="setting-up-a-recipe-for-our-example-4" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Setting up a recipe for our example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb16-1" class="hljs-ln-code"><a href="#cb16-1"></a><span class="co"># Load specific support library</span></span>
<span id="cb16-2" class="hljs-ln-code"><a href="#cb16-2"></a><span class="fu">library</span>(textrecipes)</span>
<span id="cb16-3" class="hljs-ln-code"><a href="#cb16-3"></a></span>
<span id="cb16-4" class="hljs-ln-code"><a href="#cb16-4"></a><span class="co"># Create recipe</span></span>
<span id="cb16-5" class="hljs-ln-code"><a href="#cb16-5"></a>rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(binary_genre <span class="sc">~</span> text, <span class="at">data =</span> lyrics_data) <span class="sc">|&gt;</span>              <span class="co"># &lt;-- predict binary_genre by text</span></span>
<span id="cb16-6" class="hljs-ln-code"><a href="#cb16-6"></a>  <span class="fu">step_tokenize</span>(text, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">strip_punct =</span> T,                  <span class="co"># &lt;-- tokenize, remove punctuation</span></span>
<span id="cb16-7" class="hljs-ln-code"><a href="#cb16-7"></a>                                     <span class="at">strip_numeric =</span> T)) <span class="sc">|&gt;</span>            <span class="co"># &lt;-- remove numbers</span></span>
<span id="cb16-8" class="hljs-ln-code"><a href="#cb16-8"></a>  <span class="fu">step_stopwords</span>(text, <span class="at">language =</span> <span class="st">"en"</span>) <span class="sc">|&gt;</span>                             <span class="co"># &lt;-- remove stopwords                 </span></span>
<span id="cb16-9" class="hljs-ln-code"><a href="#cb16-9"></a>  <span class="fu">step_tokenfilter</span>(text, <span class="at">min_times =</span> <span class="dv">20</span>, <span class="at">max_tokens =</span> <span class="dv">1000</span>) <span class="sc">|&gt;</span>         <span class="co"># &lt;-- filter out rare words and use only top 1000     </span></span>
<span id="cb16-10" class="hljs-ln-code"><a href="#cb16-10"></a>  <span class="fu">step_tf</span>(<span class="fu">all_predictors</span>())                                            <span class="co"># &lt;-- create document-feature matrix</span></span>
<span id="cb16-11" class="hljs-ln-code"><a href="#cb16-11"></a></span>
<span id="cb16-12" class="hljs-ln-code"><a href="#cb16-12"></a><span class="co"># Small adaption to the recipe (for SVM and neural networks)</span></span>
<span id="cb16-13" class="hljs-ln-code"><a href="#cb16-13"></a>rec_norm <span class="ot">&lt;-</span> rec <span class="sc">|&gt;</span> </span>
<span id="cb16-14" class="hljs-ln-code"><a href="#cb16-14"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_predictors</span>())    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 1,001
  binary_genre tf_text_2x tf_text_across tf_text_act tf_text_afraid tf_text_ah
  &lt;fct&gt;             &lt;int&gt;          &lt;int&gt;       &lt;int&gt;          &lt;int&gt;      &lt;int&gt;
1 rock                  0              0           0              0          0
2 other                 0              0           0              0          0
3 other                 0              0           0              0          0
4 rock                  0              0           0              0          0
5 other                 0              0           0              0          0
6 rock                  0              0           0              0          0
# ℹ 995 more variables: tf_text_ahead &lt;int&gt;, `tf_text_ain't` &lt;int&gt;,
#   tf_text_aint &lt;int&gt;, tf_text_air &lt;int&gt;, tf_text_alive &lt;int&gt;,
#   tf_text_almost &lt;int&gt;, tf_text_alone &lt;int&gt;, tf_text_along &lt;int&gt;,
#   tf_text_already &lt;int&gt;, tf_text_alright &lt;int&gt;, tf_text_always &lt;int&gt;,
#   tf_text_angel &lt;int&gt;, tf_text_angels &lt;int&gt;, tf_text_another &lt;int&gt;,
#   tf_text_answer &lt;int&gt;, tf_text_anybody &lt;int&gt;, tf_text_anymore &lt;int&gt;,
#   tf_text_anyone &lt;int&gt;, tf_text_anything &lt;int&gt;, tf_text_anyway &lt;int&gt;, …</code></pre>
</div>
</div>
</section>
<section id="overview-of-different-algorithms" class="slide level2">
<h2>Overview of different algorithms</h2>
<ul>
<li><p>There are many different “algorithms” or classifiers that we can use:</p>
<ul>
<li>Naive Bayes</li>
<li>Logistic regression</li>
<li>Support Vector Machines</li>
<li>Decision trees</li>
<li>Artificial neural networks</li>
<li>… and many more</li>
</ul></li>
<li><p>Most of these algorithms have certain hyperparameters that need to be set</p>
<ul>
<li>e.g., learning rate, regularization, structure…</li>
</ul></li>
<li><p>Unfortunately, there is no good theoretical basis for selecting an algorithm or hyperparameters</p>
<ul>
<li>Solution: Choose algorithm that performs best</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="naive-bayes" class="title-slide slide level1 center" data-background-color="steelblue">
<h1>Naive Bayes</h1>
<p>Using the Bayes Theorem for Classification</p>
</section>
<section id="theoretical-background" class="slide level2">
<h2>Theoretical background</h2>
<div class="columns">
<div class="column" style="width:43%;">
<ul>
<li><p>Goes back to the Bayes’ Theorem published in 1763!</p></li>
<li><p>Computes the prior probability ( <em>P</em> ) for every category ( <em>c</em> = outcome variable ) based on the training data set</p></li>
<li><p>Computes the probability of every feature ( <em>x</em> ) to be a characteristic of the class ( <em>c</em> ); i.e., the relative frequency of the feature in category</p></li>
</ul>
</div><div class="column" style="width:57%;">
<p><img data-src="img/naive_bayes.png"></p>
</div>
</div>
<ul>
<li><p>For every probability of a category in light of certain features ( <em>P(c|X)</em> ), all feature probabilities ( <em>x</em> ) are multiplied</p></li>
<li><p>The algorithm hence chooses the class that has highest weighted sum of inputs</p></li>
</ul>
</section>
<section id="applying-the-naive-bayes-classifier-to-our-example" class="slide level2">
<h2>Applying the Naive Bayes classifier to our example</h2>
<ul>
<li>Without any knowledge about the genre, the best estimate of whether or not a song is rock would be <em>P(rock)</em>, i.e., the probability that any prior song is rock (= class prior probability, here 54.2%)</li>
</ul>
<div class="fragment">
<ul>
<li>The algorithm now “learns” (based on the document-feature matrix) that the word “death” can often be found in rock songs. This probability is known as the likelihood <em>P(death|rock)</em> (e.g., 15%)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>The algorithm also “learns” the probability of the word “death” appearing in any song <em>P(death)</em> (predictor prior probability, e.g.&nbsp;5%). Applying the Bayes Theorem, we get:</li>
</ul>
</div>
<div class="fragment">
<p><br></p>
<center>
<p><span class="math inline">\(P(rock|death) = \frac{P(death|rock) * P(rock)}{P(death)} = \frac{.15 * .54}{.05} = .162\)</span></p>
</center>
</div>
</section>
<section id="why-using-naive-bayes" class="slide level2">
<h2>Why using Naive Bayes?</h2>
<h3 id="strengths">Strengths</h3>
<ul>
<li>Simple, fast, very effective</li>
<li>Does well with noisy and missing data</li>
<li>Requires relatively few examples for training, but also works with large numbers of examples</li>
<li>Easy to obtain the estimated probability of an estimation</li>
</ul>
<h3 id="weaknesses">Weaknesses</h3>
<ul>
<li>Relies on an often-faulty assumption that all features are equally important and independent</li>
<li>Not ideal for data sets with many numeric features</li>
<li>Estimated probabilities are less reliable than predicted classes</li>
</ul>
<p><br></p>
<p><span style="font-size:0.6em;">Lantz, 2013</span></p>
</section>
<section id="fitting-a-naive-bayes-model" class="slide level2">
<h2>Fitting a Naive Bayes model</h2>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># Create workflow </span></span>
<span id="cb18-2"><a href="#cb18-2"></a>nb_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span>                        <span class="co"># We initiate a workflow</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>  <span class="fu">add_recipe</span>(rec) <span class="sc">|&gt;</span>                                <span class="co"># We add our text preprocessing recipe to the workflow</span></span>
<span id="cb18-4"><a href="#cb18-4"></a>  <span class="fu">add_model</span>(<span class="fu">naive_Bayes</span>(<span class="at">mode =</span> <span class="st">"classification"</span>,    <span class="co"># We choose Naive Bayes for classification</span></span>
<span id="cb18-5"><a href="#cb18-5"></a>                        <span class="at">engine =</span> <span class="st">"naiveBayes"</span>))     <span class="co"># Engine = R package to be used</span></span>
<span id="cb18-6"><a href="#cb18-6"></a></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="co"># Fitting the naive bayes model</span></span>
<span id="cb18-8"><a href="#cb18-8"></a>m_nb <span class="ot">&lt;-</span> <span class="fu">fit</span>(nb_workflow, <span class="at">data =</span> <span class="fu">training</span>(split))     <span class="co"># Fitting the model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># Predict outcome in test set</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>predict_nb <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">.pred_class =</span> <span class="fu">predict</span>(m_nb, test_baked)) <span class="sc">|&gt;</span>     <span class="co"># Using 'predict' to predict genre in test set </span></span>
<span id="cb19-3"><a href="#cb19-3"></a>  <span class="fu">bind_cols</span>(<span class="fu">select</span>(<span class="fu">testing</span>(split), binary_genre)) <span class="sc">|&gt;</span>                 <span class="co"># Add actual genre of test set</span></span>
<span id="cb19-4"><a href="#cb19-4"></a>  <span class="fu">rename</span>(<span class="at">predicted=</span>.pred_class, <span class="at">actual=</span>binary_genre) </span>
<span id="cb19-5"><a href="#cb19-5"></a></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="co"># Check</span></span>
<span id="cb19-7"><a href="#cb19-7"></a>predict_nb </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb20"><pre class="sourceCode numberSource output number-lines code-with-copy"><code class="sourceCode"><span id="cb20-1"><a href="#cb20-1"></a># A tibble: 6,964 × 2</span>
<span id="cb20-2"><a href="#cb20-2"></a>   predicted actual</span>
<span id="cb20-3"><a href="#cb20-3"></a>   &lt;fct&gt;     &lt;fct&gt; </span>
<span id="cb20-4"><a href="#cb20-4"></a> 1 rock      rock  </span>
<span id="cb20-5"><a href="#cb20-5"></a> 2 other     other </span>
<span id="cb20-6"><a href="#cb20-6"></a> 3 rock      rock  </span>
<span id="cb20-7"><a href="#cb20-7"></a> 4 rock      other </span>
<span id="cb20-8"><a href="#cb20-8"></a> 5 rock      other </span>
<span id="cb20-9"><a href="#cb20-9"></a> 6 rock      other </span>
<span id="cb20-10"><a href="#cb20-10"></a> 7 rock      other </span>
<span id="cb20-11"><a href="#cb20-11"></a> 8 other     other </span>
<span id="cb20-12"><a href="#cb20-12"></a> 9 other     other </span>
<span id="cb20-13"><a href="#cb20-13"></a>10 rock      other </span>
<span id="cb20-14"><a href="#cb20-14"></a># ℹ 6,954 more rows</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="validation-on-the-test-data" class="slide level2">
<h2>Validation on the test data</h2>
<ul>
<li><p>Using the function <code>conf_mat</code> on the actual and predicted genre columns, we can now inspect the confusion matrix</p></li>
<li><p>We already see that there are many “false-positives” (1890!), but less false negatives.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># Confusion Matrix</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>predict_nb <span class="sc">|&gt;</span> </span>
<span id="cb21-3"><a href="#cb21-3"></a>  <span class="fu">conf_mat</span>(<span class="at">truth =</span> actual, <span class="at">estimate =</span> predicted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb22"><pre class="sourceCode numberSource output number-lines code-with-copy"><code class="sourceCode"><span id="cb22-1"><a href="#cb22-1"></a>          Truth</span>
<span id="cb22-2"><a href="#cb22-2"></a>Prediction rock other</span>
<span id="cb22-3"><a href="#cb22-3"></a>     rock  3536  1890</span>
<span id="cb22-4"><a href="#cb22-4"></a>     other  271  1267</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>

<img data-src="img/confusionmatrix.png" class="r-stretch"></section>
<section id="assessing-performance-scores" class="slide level2">
<h2>Assessing performance scores</h2>
<ul>
<li>In <code>tidymodels</code>, we have to define a set of measures that we want to compute based on the predictions in the test set.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># Define a set of performance scores to be computed</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>class_metrics <span class="ot">&lt;-</span> <span class="fu">metric_set</span>(accuracy, precision, recall, f_meas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>We can then use this custom function to extract the relevant measures</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># Performance Scores</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>predict_nb <span class="sc">|&gt;</span> </span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="fu">class_metrics</span>(<span class="at">truth =</span> actual, <span class="at">estimate =</span> predicted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb25"><pre class="sourceCode numberSource output number-lines code-with-copy"><code class="sourceCode"><span id="cb25-1"><a href="#cb25-1"></a># A tibble: 4 × 3</span>
<span id="cb25-2"><a href="#cb25-2"></a>  .metric   .estimator .estimate</span>
<span id="cb25-3"><a href="#cb25-3"></a>  &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt;</span>
<span id="cb25-4"><a href="#cb25-4"></a>1 accuracy  binary         0.690</span>
<span id="cb25-5"><a href="#cb25-5"></a>2 precision binary         0.652</span>
<span id="cb25-6"><a href="#cb25-6"></a>3 recall    binary         0.929</span>
<span id="cb25-7"><a href="#cb25-7"></a>4 f_meas    binary         0.766</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<ul>
<li><p>Overall accuracy is 69%, which is better than chance, but not very good.</p></li>
<li><p>Precision is also low because of a lot of false positives (65.2%)</p></li>
<li><p>Yet, recall is quite high as only few rock songs were classified as another genre (92.9%)</p></li>
</ul>
</div>
</section></section>
<section>
<section id="logistic-regression" class="title-slide slide level1 center" data-background-color="steelblue">
<h1>Logistic Regression</h1>
<p>Why not use a simple statistical model for binary classification</p>
</section>
<section id="theoretical-background-1" class="slide level2">
<h2>Theoretical background</h2>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li><p>As mentioned earlier, a linear regression can be described with the following formula:</p>
<center></center></li>
</ul>
<p><span class="math inline">\(Y_i = b_0 + b_1 x_i + \epsilon_i\)</span></p>

<ul>
<li><p>When we classify text, the dependent variable (the outcome class: <span class="math inline">\(Y_i\)</span>) is not metric, but has only two values (1 = “is class”, 0 = “is not class”).</p></li>
<li><p>We thus need to estimate the probability of <span class="math inline">\(Y = 1\)</span> by using the so-called sigmoid function:</p></li>
</ul>
<center>
<span class="math inline">\(P(Y) = \frac {1}{1+e^{-(\beta_0 + \beta_1 x)}}\)</span>
</center>
<ul>
<li><span class="math inline">\(P(Y)\)</span>: Probability of <span class="math inline">\(Y\)</span></li>
<li><span class="math inline">\(e\)</span>: Basis of the natural logarithm</li>
</ul>
</div><div class="column" style="width:40%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="03_classicmachinelearning_2023_files/figure-revealjs/unnamed-chunk-25-1.png" width="480"></p>
</div>
</div>
</div>
</div>
</section>
<section id="inverse-logit-sigmoid-function" class="slide level2">
<h2>Inverse logit (sigmoid) function</h2>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li><p>In both classic statistics as well as machine learning, this is know as <strong>logistic regression</strong></p></li>
<li><p>In machine learning, we see it as an algorithm that accomplishes binary classification tasks by predicting the probability of an outcome, event, or observation</p></li>
<li><p>To train a classifier during text classification tasks, we simply fit a logistic regression model with all text features (e.g., the frequencies of words per document) as input (predictors) and provide the outcome class as output (dependent variable)</p></li>
<li><p>In contrast to statistical models that use logistic regression, the machine learning model contains thus only much more variables!</p></li>
</ul>
</div><div class="column" style="width:40%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="03_classicmachinelearning_2023_files/figure-revealjs/unnamed-chunk-26-1.png" width="480"></p>
</div>
</div>
</div>
</div>
</section>
<section id="why-using-logistic-regression" class="slide level2">
<h2>Why using logistic regression?</h2>
<h3 id="strengths-1">Strengths</h3>
<ul>
<li>Comparatively simple model</li>
<li>We can look under the hood and investigate coefficients of individual words (-&gt; proxy for a words importance in predicting the outcome class)</li>
<li>Does comparatively well for many classification tasks!</li>
</ul>
<h3 id="weaknesses-1">Weaknesses</h3>
<ul>
<li>Dependent variable must be binary</li>
<li>Relies on an often-faulty assumption that all features are equally important and independent</li>
<li>Quite slow with many data sets and features</li>
</ul>
<p><span style="font-size:0.6em;">Lantz, 2013</span></p>
</section>
<section id="fitting-a-logistic-regression-model" class="slide level2">
<h2>Fitting a Logistic Regression model</h2>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># Additional package needed</span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="fu">library</span>(discrim)</span>
<span id="cb26-3"><a href="#cb26-3"></a></span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="co"># Creating a workflow</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>lr_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span>                            <span class="co"># Initate the workflow</span></span>
<span id="cb26-6"><a href="#cb26-6"></a>  <span class="fu">add_recipe</span>(rec) <span class="sc">|&gt;</span>                                    <span class="co"># Add recipe</span></span>
<span id="cb26-7"><a href="#cb26-7"></a>  <span class="fu">add_model</span>(<span class="fu">logistic_reg</span>(<span class="at">mixture =</span> <span class="dv">0</span>, <span class="at">penalty =</span> <span class="fl">0.1</span>,    <span class="co"># Choose logistic regression</span></span>
<span id="cb26-8"><a href="#cb26-8"></a>                         <span class="at">engine =</span> <span class="st">"glm"</span>))               <span class="co"># Standard engine</span></span>
<span id="cb26-9"><a href="#cb26-9"></a></span>
<span id="cb26-10"><a href="#cb26-10"></a><span class="co"># Fitting the logistic regression model</span></span>
<span id="cb26-11"><a href="#cb26-11"></a>m_logistic <span class="ot">&lt;-</span> <span class="fu">fit</span>(lr_workflow, <span class="at">data =</span> <span class="fu">training</span>(split))  <span class="co"># Fit model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co"># Predict outcome in test set</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>predict_lr <span class="ot">&lt;-</span> <span class="fu">predict</span>(m_logistic, <span class="at">new_data=</span>test_data) <span class="sc">|&gt;</span>  <span class="co"># Predict outcome in test data</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>  <span class="fu">bind_cols</span>(<span class="fu">select</span>(<span class="fu">testing</span>(split), binary_genre)) <span class="sc">|&gt;</span>      <span class="co"># Add actual outcome</span></span>
<span id="cb27-4"><a href="#cb27-4"></a>  <span class="fu">rename</span>(<span class="at">predicted=</span>.pred_class, <span class="at">actual=</span>binary_genre) </span>
<span id="cb27-5"><a href="#cb27-5"></a></span>
<span id="cb27-6"><a href="#cb27-6"></a><span class="co"># Check</span></span>
<span id="cb27-7"><a href="#cb27-7"></a>predict_lr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb28"><pre class="sourceCode numberSource output number-lines code-with-copy"><code class="sourceCode"><span id="cb28-1"><a href="#cb28-1"></a># A tibble: 6,964 × 2</span>
<span id="cb28-2"><a href="#cb28-2"></a>   predicted actual</span>
<span id="cb28-3"><a href="#cb28-3"></a>   &lt;fct&gt;     &lt;fct&gt; </span>
<span id="cb28-4"><a href="#cb28-4"></a> 1 rock      rock  </span>
<span id="cb28-5"><a href="#cb28-5"></a> 2 other     other </span>
<span id="cb28-6"><a href="#cb28-6"></a> 3 rock      rock  </span>
<span id="cb28-7"><a href="#cb28-7"></a> 4 other     other </span>
<span id="cb28-8"><a href="#cb28-8"></a> 5 other     other </span>
<span id="cb28-9"><a href="#cb28-9"></a> 6 other     other </span>
<span id="cb28-10"><a href="#cb28-10"></a> 7 rock      other </span>
<span id="cb28-11"><a href="#cb28-11"></a> 8 other     other </span>
<span id="cb28-12"><a href="#cb28-12"></a> 9 other     other </span>
<span id="cb28-13"><a href="#cb28-13"></a>10 rock      other </span>
<span id="cb28-14"><a href="#cb28-14"></a># ℹ 6,954 more rows</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="validation" class="slide level2">
<h2>Validation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb29" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="co"># Confusion Matrix</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>predict_lr <span class="sc">|&gt;</span> </span>
<span id="cb29-3"><a href="#cb29-3"></a>  <span class="fu">conf_mat</span>(<span class="at">truth =</span> actual, <span class="at">estimate =</span> predicted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb30"><pre class="sourceCode numberSource output number-lines code-with-copy"><code class="sourceCode"><span id="cb30-1"><a href="#cb30-1"></a>          Truth</span>
<span id="cb30-2"><a href="#cb30-2"></a>Prediction rock other</span>
<span id="cb30-3"><a href="#cb30-3"></a>     rock  3171  1123</span>
<span id="cb30-4"><a href="#cb30-4"></a>     other  636  2034</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># Performance Scores</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>predict_lr <span class="sc">|&gt;</span> </span>
<span id="cb31-3"><a href="#cb31-3"></a>  <span class="fu">class_metrics</span>(<span class="at">truth =</span> actual, <span class="at">estimate =</span> predicted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb32"><pre class="sourceCode numberSource output number-lines code-with-copy"><code class="sourceCode"><span id="cb32-1"><a href="#cb32-1"></a># A tibble: 4 × 3</span>
<span id="cb32-2"><a href="#cb32-2"></a>  .metric   .estimator .estimate</span>
<span id="cb32-3"><a href="#cb32-3"></a>  &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt;</span>
<span id="cb32-4"><a href="#cb32-4"></a>1 accuracy  binary         0.747</span>
<span id="cb32-5"><a href="#cb32-5"></a>2 precision binary         0.738</span>
<span id="cb32-6"><a href="#cb32-6"></a>3 recall    binary         0.833</span>
<span id="cb32-7"><a href="#cb32-7"></a>4 f_meas    binary         0.783</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<ul>
<li><p>Overall accuracy of the Logistic Regression classifier is 74.7%, which is better than the Naive Bayes!</p></li>
<li><p>Precision is also ok due to less false positives (73.8%)</p></li>
<li><p>Yet, recall is slightly lower, but still good (83.3%)</p></li>
</ul>
</div>
</section>
<section id="what-words-best-predict-rock" class="slide level2">
<h2>What words best predict rock?</h2>
<ul>
<li>Because a logistic regression model estimates “slopes” for individual words, we can extract those words the best predict whether a song is rock (or not)</li>
</ul>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb33" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>m_logistic <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a href="#cb33-2"></a>  <span class="fu">extract_fit_parsnip</span>() <span class="sc">|&gt;</span></span>
<span id="cb33-3"><a href="#cb33-3"></a>  vip<span class="sc">::</span><span class="fu">vi</span>() <span class="sc">|&gt;</span> </span>
<span id="cb33-4"><a href="#cb33-4"></a>  <span class="fu">group_by</span>(Sign) <span class="sc">|&gt;</span></span>
<span id="cb33-5"><a href="#cb33-5"></a>  <span class="fu">mutate</span>(<span class="at">Sign =</span> <span class="fu">recode</span>(Sign, </span>
<span id="cb33-6"><a href="#cb33-6"></a>                       <span class="at">POS =</span> <span class="st">"negative"</span>, </span>
<span id="cb33-7"><a href="#cb33-7"></a>                       <span class="at">NEG =</span> <span class="st">"positive"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb33-8"><a href="#cb33-8"></a>  <span class="fu">top_n</span>(<span class="dv">20</span>, <span class="at">wt =</span> <span class="fu">abs</span>(Importance)) <span class="sc">|&gt;</span> </span>
<span id="cb33-9"><a href="#cb33-9"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb33-10"><a href="#cb33-10"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-11"><a href="#cb33-11"></a>    <span class="at">Importance =</span> <span class="fu">abs</span>(Importance),</span>
<span id="cb33-12"><a href="#cb33-12"></a>    <span class="at">Variable =</span> <span class="fu">str_remove</span>(Variable, <span class="st">"tf_text_"</span>),</span>
<span id="cb33-13"><a href="#cb33-13"></a>    <span class="at">Variable =</span> <span class="fu">fct_reorder</span>(Variable, Importance)</span>
<span id="cb33-14"><a href="#cb33-14"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb33-15"><a href="#cb33-15"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Importance, </span>
<span id="cb33-16"><a href="#cb33-16"></a>             <span class="at">y =</span> Variable, </span>
<span id="cb33-17"><a href="#cb33-17"></a>             <span class="at">fill =</span> Sign)) <span class="sc">+</span></span>
<span id="cb33-18"><a href="#cb33-18"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb33-19"><a href="#cb33-19"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Sign, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb33-20"><a href="#cb33-20"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column fragment">
<div class="cell-output-display">
<p><img data-src="03_classicmachinelearning_2023_files/figure-revealjs/unnamed-chunk-32-1.png" width="480"></p>
</div>
</div>
</div>
</section></section>
<section id="break-5-minutes" class="title-slide slide level1 center" data-background-color="black">
<h1>Break (5 Minutes)</h1>

</section>

<section>
<section id="support-vector-machines" class="title-slide slide level1 center" data-background-color="steelblue">
<h1>Support Vector Machines</h1>
<p>A versatile black box method</p>
</section>
<section id="theoretical-background-2" class="slide level2">
<h2>Theoretical background</h2>
<ul>
<li><p>Very often used machine learning method, due to its high performance in a variety of tasks</p></li>
<li><p>A support vector machine (SVM) can be imagined as a “surface” that creates the greatest separation between two groups in a multidimensional space representing classes and their feature values</p></li>
<li><p>Tries to find decision boundary between points that maximizes margin between classes while minimizing errors</p></li>
<li><p>More formally, a support-vector machine constructs a hyperplane or set of hyperplanes in a high- or infinite-dimensional space (wait what?)</p></li>
</ul>
</section>
<section id="classification-with-hyperplanes" class="slide level2">
<h2>Classification with hyperplanes</h2>
<div class="columns">
<div class="column" style="width:45%;">
<ul>
<li><p>The following figure depicts two groups of data that can be plotted in two dimensions (here, I show only two dimensions because it is difficult to imagine or illustrate space in greater than two dimensions)</p></li>
<li><p>Because the groups are perfectly separatable by a straight line, they are said to be linearly separable (but hyperplanes don’t have to be linear)</p></li>
</ul>
</div><div class="column" style="width:55%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="03_classicmachinelearning_2023_files/figure-revealjs/unnamed-chunk-33-1.png" width="528"></p>
</div>
</div>
</div>
</div>
</section>
<section id="classification-with-hyperplanes-1" class="slide level2">
<h2>Classification with hyperplanes</h2>
<div class="columns">
<div class="column" style="width:45%;">
<ul>
<li><p>The following figure depicts two groups of data that can be plotted in two dimensions (here, I show only two dimensions because it is difficult to imagine or illustrate space in greater than two dimensions)</p></li>
<li><p>Because the groups are perfectly separatable by a straight line, they are said to be linearly separable (but hyperplanes don’t have to be linear)</p></li>
</ul>
</div><div class="column" style="width:55%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="03_classicmachinelearning_2023_files/figure-revealjs/unnamed-chunk-34-1.png" width="528"></p>
</div>
</div>
</div>
</div>
</section>
<section id="classification-with-hyperplanes-2" class="slide level2">
<h2>Classification with hyperplanes</h2>
<div class="columns">
<div class="column" style="width:45%;">
<ul>
<li><p>The task of the SVM algorithm is to identify a line that separates the two classes, but there os always more than one choice</p></li>
<li><p>Therefore, the algorithm searches for the maximum margin hyperplane (MMH) that creates the greatest separation between the two classes, although any of the three lines separates the classes, the line that leads to the greatest separation will generalize best to new data</p></li>
<li><p>The support vectors are the points from each class that are closest to the MMH (each class must have at least on support vector)</p></li>
</ul>
</div><div class="column" style="width:55%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="03_classicmachinelearning_2023_files/figure-revealjs/unnamed-chunk-35-1.png" width="528"></p>
</div>
</div>
</div>
</div>
</section>
<section id="classification-with-hyperplanes-3" class="slide level2">
<h2>Classification with hyperplanes</h2>
<div class="columns">
<div class="column" style="width:45%;">
<ul>
<li><p>The task of the SVM algorithm is to identify a line that separates the two classes, but there os always more than one choice</p></li>
<li><p>Therefore, the algorithm searches for the maximum margin hyperplane (MMH) that creates the greatest separation between the two classes, although any of the three lines separates the classes, the line that leads to the greatest separation will generalize best to new data</p></li>
<li><p>The support vectors are the points from each class that are closest to the MMH (each class must have at least on support vector)</p></li>
</ul>
</div><div class="column" style="width:55%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="03_classicmachinelearning_2023_files/figure-revealjs/unnamed-chunk-36-1.png" width="528"></p>
</div>
</div>
</div>
</div>
</section>
<section id="why-using-support-vector-machines" class="slide level2">
<h2>Why using support vector machines?</h2>
<h3 id="strengths-2">Strengths</h3>
<ul>
<li>Can be used for classification or numeric prediction</li>
<li>Not overly influenced by noisy data, not prone to overfitting</li>
<li>Easier to use than neural networks</li>
<li>Often high accuracy!</li>
</ul>
<h3 id="weaknesses-2">Weaknesses</h3>
<ul>
<li>Finding the best model requires testing of various combinations of model parameters</li>
<li>Can be slow to train, particularly with many features</li>
<li>Results in a complex ‘black box’ that is difficult, if not impossible to understand</li>
</ul>
<p><span style="font-size:0.6em;">Lantz, 2013</span></p>
</section>
<section id="fitting-a-svm-model" class="slide level2">
<h2>Fitting a SVM model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="fu">load</span>(<span class="st">"results/m_svm.Rdata"</span>)</span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="co">#save(m_svm, file = "results/m_svm.Rdata")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="fu">library</span>(LiblineaR)</span>
<span id="cb35-2"><a href="#cb35-2"></a>svm_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb35-3"><a href="#cb35-3"></a>  <span class="fu">add_recipe</span>(rec_norm) <span class="sc">|&gt;</span></span>
<span id="cb35-4"><a href="#cb35-4"></a>  <span class="fu">add_model</span>(<span class="fu">svm_linear</span>(<span class="at">mode =</span> <span class="st">"classification"</span>, </span>
<span id="cb35-5"><a href="#cb35-5"></a>                     <span class="at">engine =</span> <span class="st">"LiblineaR"</span>))</span>
<span id="cb35-6"><a href="#cb35-6"></a></span>
<span id="cb35-7"><a href="#cb35-7"></a><span class="co"># Fitting the logistic regression model</span></span>
<span id="cb35-8"><a href="#cb35-8"></a>m_svm <span class="ot">&lt;-</span> <span class="fu">fit</span>(svm_workflow, <span class="at">data =</span> train_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co"># Predict outcome in test data</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>predict_svm <span class="ot">&lt;-</span> <span class="fu">predict</span>(m_svm, <span class="at">new_data=</span><span class="fu">testing</span>(split)) <span class="sc">|&gt;</span></span>
<span id="cb36-3"><a href="#cb36-3"></a>  <span class="fu">bind_cols</span>(<span class="fu">select</span>(<span class="fu">testing</span>(split), binary_genre)) <span class="sc">|&gt;</span></span>
<span id="cb36-4"><a href="#cb36-4"></a>  <span class="fu">rename</span>(<span class="at">predicted=</span>.pred_class, <span class="at">actual=</span>binary_genre)</span>
<span id="cb36-5"><a href="#cb36-5"></a></span>
<span id="cb36-6"><a href="#cb36-6"></a><span class="co"># Check</span></span>
<span id="cb36-7"><a href="#cb36-7"></a>predict_svm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb37"><pre class="sourceCode numberSource output number-lines code-with-copy"><code class="sourceCode"><span id="cb37-1"><a href="#cb37-1"></a># A tibble: 6,964 × 2</span>
<span id="cb37-2"><a href="#cb37-2"></a>   predicted actual</span>
<span id="cb37-3"><a href="#cb37-3"></a>   &lt;fct&gt;     &lt;fct&gt; </span>
<span id="cb37-4"><a href="#cb37-4"></a> 1 rock      rock  </span>
<span id="cb37-5"><a href="#cb37-5"></a> 2 other     other </span>
<span id="cb37-6"><a href="#cb37-6"></a> 3 rock      rock  </span>
<span id="cb37-7"><a href="#cb37-7"></a> 4 other     other </span>
<span id="cb37-8"><a href="#cb37-8"></a> 5 rock      other </span>
<span id="cb37-9"><a href="#cb37-9"></a> 6 other     other </span>
<span id="cb37-10"><a href="#cb37-10"></a> 7 rock      other </span>
<span id="cb37-11"><a href="#cb37-11"></a> 8 other     other </span>
<span id="cb37-12"><a href="#cb37-12"></a> 9 other     other </span>
<span id="cb37-13"><a href="#cb37-13"></a>10 rock      other </span>
<span id="cb37-14"><a href="#cb37-14"></a># ℹ 6,954 more rows</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="validation-1" class="slide level2">
<h2>Validation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb38" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="co"># Confusion matrix</span></span>
<span id="cb38-2"><a href="#cb38-2"></a>predict_svm <span class="sc">|&gt;</span> </span>
<span id="cb38-3"><a href="#cb38-3"></a>  <span class="fu">conf_mat</span>(<span class="at">truth =</span> actual, <span class="at">estimate =</span> predicted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb39"><pre class="sourceCode numberSource output number-lines code-with-copy"><code class="sourceCode"><span id="cb39-1"><a href="#cb39-1"></a>          Truth</span>
<span id="cb39-2"><a href="#cb39-2"></a>Prediction rock other</span>
<span id="cb39-3"><a href="#cb39-3"></a>     rock  3094  1126</span>
<span id="cb39-4"><a href="#cb39-4"></a>     other  713  2031</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="co"># Performance scores</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>predict_svm <span class="sc">|&gt;</span> </span>
<span id="cb40-3"><a href="#cb40-3"></a>  <span class="fu">class_metrics</span>(<span class="at">truth =</span> actual, <span class="at">estimate =</span> predicted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb41"><pre class="sourceCode numberSource output number-lines code-with-copy"><code class="sourceCode"><span id="cb41-1"><a href="#cb41-1"></a># A tibble: 4 × 3</span>
<span id="cb41-2"><a href="#cb41-2"></a>  .metric   .estimator .estimate</span>
<span id="cb41-3"><a href="#cb41-3"></a>  &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt;</span>
<span id="cb41-4"><a href="#cb41-4"></a>1 accuracy  binary         0.736</span>
<span id="cb41-5"><a href="#cb41-5"></a>2 precision binary         0.733</span>
<span id="cb41-6"><a href="#cb41-6"></a>3 recall    binary         0.813</span>
<span id="cb41-7"><a href="#cb41-7"></a>4 f_meas    binary         0.771</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<ul>
<li><p>Overall performance is very similar to logistic regression</p></li>
<li><p>Can probably be improved with fine-tuning of hyper-parameters</p></li>
</ul>
</div>
</section></section>
<section>
<section id="artificial-neural-networks" class="title-slide slide level1 center" data-background-color="steelblue">
<h1>Artificial Neural Networks</h1>
<p>The human brain abstracted to a numerical model</p>
</section>
<section id="theoretical-background-3" class="slide level2">
<h2>Theoretical background</h2>
<ul>
<li><p>An artificial neural network (ANN) models the relationship between a set of input signals and an output signal using a model derived from our understanding of the human brain</p></li>
<li><p>Like a brain uses a network of interconnected cells called “neurons” (a) to provide fast learning capabilities, ANN uses a network of artificial neurons (b) to solves learning tasks</p></li>
</ul>

<img data-src="https://miro.medium.com/v2/resize:fit:850/1*30YDnisanIYRHpC-L2Br-g.png" class="r-stretch quarto-figure-center"><p class="caption">Source: Arthur Arnx/Medium</p></section>
<section id="how-does-a-neural-network-work" class="slide level2">
<h2>How does a neural network work?</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/neuralnetwork2.png"></p>
</div><div class="column" style="width:50%;">
<ul>
<li><p>The operation of an ANN is straightforward:</p>
<ul>
<li>One enters variables as inputs (e.g., features of a text)</li>
<li>And after some calculations via different neurons, an output is returned (e.g.&nbsp;the word “politics”)</li>
</ul></li>
<li><p>In the simplest form, neurons on are stacked on top of one another and a neuron of colum <code>n</code> can only be connected to inputs from column <code>n-1</code> and provide outputs to neurons in column <code>n+1</code></p></li>
</ul>
</div>
</div>
</section>
<section id="the-neuron-as-generalized-linear-model" class="slide level2">
<h2>The Neuron as generalized linear model</h2>
<ul>
<li><p>First, a neuron adds up the value of every neurons from the previous column it is connected to (here <code>x1</code>, <code>x2</code>, and <code>x3</code>)</p></li>
<li><p>This value is multiplied, before being added, by another variable called “weight” (<code>w1</code>, <code>w2</code>, <code>w3</code>): the strength of connection between two neurons</p></li>
<li><p>A bias value may be added (e.g., to regularize the network)</p></li>
<li><p>After all those summations, the neuron finally applies a function called <strong>activation function</strong> to the obtained value</p></li>
</ul>

<img data-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*UA30b0mJUPYoPvN8yJr2iQ.jpeg" class="r-stretch quarto-figure-center"><p class="caption">Source: Arthur Arnx/Medium</p></section>
<section id="the-activation-function" class="slide level2">
<h2>The activation function</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>The activation function serves to turn the total value calculated to a number between 0 and 1</p></li>
<li><p>A threshold then defines at what value the function should “fire” the output to the next neuron (of course this can be probabilistic)</p></li>
<li><p>We can choose from different activation functions; which works best is sometimes hard to tell</p></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/activation-functions.jpg"></p>
<p></p><figcaption>Source: AI Wiki</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="how-the-neural-network-learns" class="slide level2">
<h2>How the neural network learns</h2>
<ul>
<li><p><img data-src="https://developer-blogs.nvidia.com/wp-content/uploads/2022/02/DS-Guide-to-Gradient-Descent_Pic5.gif" style="float:right; padding-left: 2em; padding-bottom: 2em;" alt="Source: 3Blue1Brown">In a first try, the ANN randomly sets weights and thus can’t get the right output (except with luck)</p></li>
<li><p>If the (random) choice was a good one, actual parameters are kept and the next input is given. If the obtained output doesn’t match the desired output, the weights are changed.</p></li>
<li><p>To determine which weight is better to modify, a ANN uses <strong>backpropagation</strong>, which consists of “going back” on the neural network and inspect every connection to check how the output would behave according to a change on the weight</p></li>
<li><p>The <strong>learning rate</strong> thereby determines the speed a neural network will learn, i.e., how it will modify a weight (e.g., little by little or by bigger steps).</p></li>
<li><p>Learning rate and number of learning cycles (epochs) have to be set manually upfront!</p></li>
</ul>
</section>
<section id="architecture-of-a-neural-network" class="slide level2">
<h2>Architecture of a neural network</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p><img data-src="img/neuralnetwork2.png"></p>
</div><div class="column" style="width:60%;">
<ul>
<li><p>A simple model with just inputs and outputs is called a perceptron</p></li>
<li><p>Despite its usefulness for many tasks, it cannot combine features</p></li>
<li><p>But we can add “hidden” layers (latent variables), creating a multilayer perceptron, which is able to process more complex inputs</p></li>
<li><p>Backpropagation is thus the way a neural network adjusts the weights of its connections (-&gt; Can take a long time to find the right solutions)</p></li>
</ul>
</div>
</div>
<div class="fragment">
<p><strong>Universal approximator:</strong> Neural Networks with single hidden layer can represent every continuous function!</p>
</div>
</section>
<section id="why-use-neural-networks" class="slide level2">
<h2>Why use neural networks?</h2>
<h3 id="strengths-3">Strengths</h3>
<ul>
<li>Can be adapted to almost any prediction problem</li>
<li>Capable of modelling more complex patterns than nearly any other algorithm</li>
<li>Makes few assumptions about the data’s underlying characteristics</li>
</ul>
<h3 id="weaknesses-3">Weaknesses</h3>
<ul>
<li>Extremely computationally intensive and thus slow (however, simple models still fast)</li>
<li>Very prone to overfitting</li>
<li>Results in a complex ‘black box’ that is difficult, if not impossible to interpret</li>
</ul>
<p><span style="font-size:0.6em;">Lantz, 2013</span></p>
</section>
<section id="fitting-an-artifical-neural-network" class="slide level2">
<h2>Fitting an artifical neural network</h2>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="co"># For replication purposes</span></span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb42-3"><a href="#cb42-3"></a></span>
<span id="cb42-4"><a href="#cb42-4"></a><span class="co"># Specify multilayer perceptron</span></span>
<span id="cb42-5"><a href="#cb42-5"></a>nnet_spec <span class="ot">&lt;-</span> </span>
<span id="cb42-6"><a href="#cb42-6"></a>  <span class="fu">mlp</span>(<span class="at">epochs =</span> <span class="dv">400</span>,          <span class="co"># &lt;- times that algorithm will work through train set</span></span>
<span id="cb42-7"><a href="#cb42-7"></a>      <span class="at">hidden_units =</span> <span class="fu">c</span>(<span class="dv">6</span>),   <span class="co"># &lt;- nodes in hidden units</span></span>
<span id="cb42-8"><a href="#cb42-8"></a>      <span class="at">penalty =</span> <span class="fl">0.01</span>,        <span class="co"># &lt;- regularization</span></span>
<span id="cb42-9"><a href="#cb42-9"></a>      <span class="at">learn_rate =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span>   <span class="co"># &lt;- shrinkage</span></span>
<span id="cb42-10"><a href="#cb42-10"></a>  <span class="fu">set_engine</span>(<span class="st">"brulee"</span>) <span class="sc">|&gt;</span>    <span class="co"># &lt;-- engine = R package</span></span>
<span id="cb42-11"><a href="#cb42-11"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src="img/text_neural_network.png" class="r-stretch"></section>
<section id="fitting-an-artifical-neural-network-1" class="slide level2">
<h2>Fitting an artifical neural network</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb43" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="co"># For replication purposes</span></span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb43-3"><a href="#cb43-3"></a></span>
<span id="cb43-4"><a href="#cb43-4"></a><span class="co"># Specify multilayer perceptron</span></span>
<span id="cb43-5"><a href="#cb43-5"></a>nnet_spec <span class="ot">&lt;-</span> </span>
<span id="cb43-6"><a href="#cb43-6"></a>  <span class="fu">mlp</span>(<span class="at">epochs =</span> <span class="dv">400</span>,          <span class="co"># &lt;- times that algorithm will work through train set</span></span>
<span id="cb43-7"><a href="#cb43-7"></a>      <span class="at">hidden_units =</span> <span class="fu">c</span>(<span class="dv">6</span>),   <span class="co"># &lt;- nodes in hidden units</span></span>
<span id="cb43-8"><a href="#cb43-8"></a>      <span class="at">penalty =</span> <span class="fl">0.01</span>,        <span class="co"># &lt;- regularization</span></span>
<span id="cb43-9"><a href="#cb43-9"></a>      <span class="at">learn_rate =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span>   <span class="co"># &lt;- shrinkage</span></span>
<span id="cb43-10"><a href="#cb43-10"></a>  <span class="fu">set_engine</span>(<span class="st">"brulee"</span>) <span class="sc">|&gt;</span>    <span class="co"># &lt;-- engine = R package</span></span>
<span id="cb43-11"><a href="#cb43-11"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src="img/text_neural_network2.png" class="r-stretch"></section>
<section id="fitting-an-artifical-neural-network-2" class="slide level2">
<h2>Fitting an artifical neural network</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb44" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="co"># For replication purposes</span></span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb44-3"><a href="#cb44-3"></a></span>
<span id="cb44-4"><a href="#cb44-4"></a><span class="co"># Specify multilayer perceptron</span></span>
<span id="cb44-5"><a href="#cb44-5"></a>nnet_spec <span class="ot">&lt;-</span> </span>
<span id="cb44-6"><a href="#cb44-6"></a>  <span class="fu">mlp</span>(<span class="at">epochs =</span> <span class="dv">400</span>,          <span class="co"># &lt;- times that algorithm will work through train set</span></span>
<span id="cb44-7"><a href="#cb44-7"></a>      <span class="at">hidden_units =</span> <span class="fu">c</span>(<span class="dv">6</span>),   <span class="co"># &lt;- nodes in hidden units</span></span>
<span id="cb44-8"><a href="#cb44-8"></a>      <span class="at">penalty =</span> <span class="fl">0.01</span>,        <span class="co"># &lt;- regularization</span></span>
<span id="cb44-9"><a href="#cb44-9"></a>      <span class="at">learn_rate =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span>   <span class="co"># &lt;- shrinkage</span></span>
<span id="cb44-10"><a href="#cb44-10"></a>  <span class="fu">set_engine</span>(<span class="st">"brulee"</span>) <span class="sc">|&gt;</span>    <span class="co"># &lt;-- engine = R package</span></span>
<span id="cb44-11"><a href="#cb44-11"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src="img/text_neural_network3.png" class="r-stretch"></section>
<section id="fitting-an-artifical-neural-network-3" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Fitting an artifical neural network</h2>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb45-1" class="hljs-ln-code"><a href="#cb45-1"></a><span class="co"># For replication purposes</span></span>
<span id="cb45-2" class="hljs-ln-code"><a href="#cb45-2"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb45-3" class="hljs-ln-code"><a href="#cb45-3"></a></span>
<span id="cb45-4" class="hljs-ln-code"><a href="#cb45-4"></a><span class="co"># Specify multilayer perceptron</span></span>
<span id="cb45-5" class="hljs-ln-code"><a href="#cb45-5"></a>nnet_spec <span class="ot">&lt;-</span> </span>
<span id="cb45-6" class="hljs-ln-code"><a href="#cb45-6"></a>  <span class="fu">mlp</span>(<span class="at">epochs =</span> <span class="dv">400</span>,          <span class="co"># &lt;- times that algorithm will work through train set</span></span>
<span id="cb45-7" class="hljs-ln-code"><a href="#cb45-7"></a>      <span class="at">hidden_units =</span> <span class="fu">c</span>(<span class="dv">6</span>),   <span class="co"># &lt;- nodes in hidden units</span></span>
<span id="cb45-8" class="hljs-ln-code"><a href="#cb45-8"></a>      <span class="at">penalty =</span> <span class="fl">0.01</span>,        <span class="co"># &lt;- regularization</span></span>
<span id="cb45-9" class="hljs-ln-code"><a href="#cb45-9"></a>      <span class="at">learn_rate =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span>   <span class="co"># &lt;- shrinkage</span></span>
<span id="cb45-10" class="hljs-ln-code"><a href="#cb45-10"></a>  <span class="fu">set_engine</span>(<span class="st">"brulee"</span>) <span class="sc">|&gt;</span>    <span class="co"># &lt;-- engine = R package</span></span>
<span id="cb45-11" class="hljs-ln-code"><a href="#cb45-11"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb45-12" class="hljs-ln-code"><a href="#cb45-12"></a></span>
<span id="cb45-13" class="hljs-ln-code"><a href="#cb45-13"></a><span class="co"># Create workflow</span></span>
<span id="cb45-14" class="hljs-ln-code"><a href="#cb45-14"></a>ann_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb45-15" class="hljs-ln-code"><a href="#cb45-15"></a>  <span class="fu">add_recipe</span>(rec_norm) <span class="sc">|&gt;</span>    <span class="co"># Use updated recipe with normalization</span></span>
<span id="cb45-16" class="hljs-ln-code"><a href="#cb45-16"></a>  <span class="fu">add_model</span>(nnet_spec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fitting-an-artifical-neural-network-4" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Fitting an artifical neural network</h2>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="co"># For replication purposes</span></span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb46-3"><a href="#cb46-3"></a></span>
<span id="cb46-4"><a href="#cb46-4"></a><span class="co"># Specify multilayer perceptron</span></span>
<span id="cb46-5"><a href="#cb46-5"></a>nnet_spec <span class="ot">&lt;-</span> </span>
<span id="cb46-6"><a href="#cb46-6"></a>  <span class="fu">mlp</span>(<span class="at">epochs =</span> <span class="dv">400</span>,          <span class="co"># &lt;- times that algorithm will work through train set</span></span>
<span id="cb46-7"><a href="#cb46-7"></a>      <span class="at">hidden_units =</span> <span class="fu">c</span>(<span class="dv">6</span>),   <span class="co"># &lt;- nodes in hidden units</span></span>
<span id="cb46-8"><a href="#cb46-8"></a>      <span class="at">penalty =</span> <span class="fl">0.01</span>,        <span class="co"># &lt;- regularization</span></span>
<span id="cb46-9"><a href="#cb46-9"></a>      <span class="at">learn_rate =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span>   <span class="co"># &lt;- shrinkage</span></span>
<span id="cb46-10"><a href="#cb46-10"></a>  <span class="fu">set_engine</span>(<span class="st">"brulee"</span>) <span class="sc">|&gt;</span>    <span class="co"># &lt;-- engine = R package</span></span>
<span id="cb46-11"><a href="#cb46-11"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb46-12"><a href="#cb46-12"></a></span>
<span id="cb46-13"><a href="#cb46-13"></a><span class="co"># Create workflow</span></span>
<span id="cb46-14"><a href="#cb46-14"></a>ann_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb46-15"><a href="#cb46-15"></a>  <span class="fu">add_recipe</span>(rec_norm) <span class="sc">|&gt;</span>    <span class="co"># Use updated recipe with normalization</span></span>
<span id="cb46-16"><a href="#cb46-16"></a>  <span class="fu">add_model</span>(nnet_spec)</span>
<span id="cb46-17"><a href="#cb46-17"></a></span>
<span id="cb46-18"><a href="#cb46-18"></a><span class="co"># Fit model</span></span>
<span id="cb46-19"><a href="#cb46-19"></a>m_ann <span class="ot">&lt;-</span> <span class="fu">fit</span>(ann_workflow, train_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="co"># Predict outcome in test data</span></span>
<span id="cb47-2"><a href="#cb47-2"></a>predict_ann <span class="ot">&lt;-</span> <span class="fu">predict</span>(m_ann, <span class="at">new_data=</span>test_data) <span class="sc">|&gt;</span></span>
<span id="cb47-3"><a href="#cb47-3"></a>  <span class="fu">bind_cols</span>(<span class="fu">select</span>(<span class="fu">testing</span>(split), binary_genre)) <span class="sc">|&gt;</span></span>
<span id="cb47-4"><a href="#cb47-4"></a>  <span class="fu">rename</span>(<span class="at">predicted=</span>.pred_class, <span class="at">actual=</span>binary_genre)</span>
<span id="cb47-5"><a href="#cb47-5"></a></span>
<span id="cb47-6"><a href="#cb47-6"></a><span class="co"># Check</span></span>
<span id="cb47-7"><a href="#cb47-7"></a>predict_ann <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb48"><pre class="sourceCode numberSource output number-lines code-with-copy"><code class="sourceCode"><span id="cb48-1"><a href="#cb48-1"></a># A tibble: 4 × 2</span>
<span id="cb48-2"><a href="#cb48-2"></a>  predicted actual</span>
<span id="cb48-3"><a href="#cb48-3"></a>  &lt;fct&gt;     &lt;fct&gt; </span>
<span id="cb48-4"><a href="#cb48-4"></a>1 rock      rock  </span>
<span id="cb48-5"><a href="#cb48-5"></a>2 other     other </span>
<span id="cb48-6"><a href="#cb48-6"></a>3 rock      rock  </span>
<span id="cb48-7"><a href="#cb48-7"></a>4 other     other </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="validation-2" class="slide level2">
<h2>Validation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb49" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="co"># Confusion matrix</span></span>
<span id="cb49-2"><a href="#cb49-2"></a>predict_ann <span class="sc">|&gt;</span> </span>
<span id="cb49-3"><a href="#cb49-3"></a>  <span class="fu">conf_mat</span>(<span class="at">truth =</span> actual, <span class="at">estimate =</span> predicted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb50"><pre class="sourceCode numberSource output number-lines code-with-copy"><code class="sourceCode"><span id="cb50-1"><a href="#cb50-1"></a>          Truth</span>
<span id="cb50-2"><a href="#cb50-2"></a>Prediction rock other</span>
<span id="cb50-3"><a href="#cb50-3"></a>     rock  3367  1305</span>
<span id="cb50-4"><a href="#cb50-4"></a>     other  440  1852</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="co"># Performance score</span></span>
<span id="cb51-2"><a href="#cb51-2"></a>predict_ann <span class="sc">|&gt;</span> </span>
<span id="cb51-3"><a href="#cb51-3"></a>  <span class="fu">class_metrics</span>(<span class="at">truth =</span> actual, <span class="at">estimate =</span> predicted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb52"><pre class="sourceCode numberSource output number-lines code-with-copy"><code class="sourceCode"><span id="cb52-1"><a href="#cb52-1"></a># A tibble: 4 × 3</span>
<span id="cb52-2"><a href="#cb52-2"></a>  .metric   .estimator .estimate</span>
<span id="cb52-3"><a href="#cb52-3"></a>  &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt;</span>
<span id="cb52-4"><a href="#cb52-4"></a>1 accuracy  binary         0.749</span>
<span id="cb52-5"><a href="#cb52-5"></a>2 precision binary         0.721</span>
<span id="cb52-6"><a href="#cb52-6"></a>3 recall    binary         0.884</span>
<span id="cb52-7"><a href="#cb52-7"></a>4 f_meas    binary         0.794</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<ul>
<li><p>Highest accuracy of all four algorithms (74.9%)</p></li>
<li><p>Most balanced performance scores</p></li>
<li><p>Yet, performance overall similar to logistic regression and SVM</p></li>
</ul>
</div>
</section></section>
<section>
<section id="testing-different-algorithms-and-recipes" class="title-slide slide level1 center" data-background-color="steelblue">
<h1>Testing Different Algorithms and Recipes</h1>

</section>
<section id="comparison-of-the-previous-approaches" class="slide level2">
<h2>Comparison of the previous approaches</h2>

<img data-src="03_classicmachinelearning_2023_files/figure-revealjs/unnamed-chunk-53-1.png" width="960" class="r-stretch"></section>
<section id="fine-tuning-preprocessing-and-hyperparameter" class="slide level2">
<h2>Fine-tuning preprocessing and hyperparameter</h2>
<ul>
<li><p>You may have noticed that I always set some <strong>hyperparameter</strong> in all of the models</p></li>
<li><p>There is no clear rule of how to set these parameters and their influence on performance is often unknown</p></li>
<li><p>Using trail and error, we simply compare many different model specifications to find optimal hyperparameters</p></li>
<li><p>Very good examples are the hyperparameters of support vector machines: it is hard to know how soft our margins should be and we may also be unsure about the right kernel , or in the case of a polynomial kernel, how many degrees we want to consider</p></li>
<li><p>Similarly, we have to simply try out whether a neural network needs more than one hidden layer or how many nodes make sense, what learning rate works best, etc.</p></li>
<li><p>Good machine learning practice is to conduct a so-called <strong>grid-search</strong>, i.e.&nbsp;systematically run combinations of different specifications (but computationally expensive!!!)</p></li>
</ul>
<p><span style="font-size:0.6em;">Hvitfeld &amp; Silge (2021)</span></p>
</section>
<section id="grid-search-for-best-neural-network-architecture" class="slide level2">
<h2>Grid search for best neural network architecture</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb53" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="co"># Create a model function for tuning a multilayer perceptrion neural network</span></span>
<span id="cb53-2"><a href="#cb53-2"></a>mlp_spec <span class="ot">&lt;-</span> <span class="fu">mlp</span>(<span class="at">hidden_units =</span> <span class="fu">tune</span>(),     <span class="co">#</span></span>
<span id="cb53-3"><a href="#cb53-3"></a>                <span class="at">penalty =</span> <span class="fu">tune</span>(), </span>
<span id="cb53-4"><a href="#cb53-4"></a>                <span class="at">epochs =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb53-5"><a href="#cb53-5"></a>  <span class="fu">set_engine</span>(<span class="st">"brulee"</span>, <span class="at">trace =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb53-6"><a href="#cb53-6"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="grid-search-for-best-neural-network-architecture-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Grid search for best neural network architecture</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb54" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="co"># Create a model function for tuning a multilayer perceptrion neural network</span></span>
<span id="cb54-2"><a href="#cb54-2"></a>mlp_spec <span class="ot">&lt;-</span> <span class="fu">mlp</span>(<span class="at">hidden_units =</span> <span class="fu">tune</span>(),     </span>
<span id="cb54-3"><a href="#cb54-3"></a>                <span class="at">penalty =</span> <span class="fu">tune</span>(), </span>
<span id="cb54-4"><a href="#cb54-4"></a>                <span class="at">epochs =</span> <span class="fu">tune</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb54-5"><a href="#cb54-5"></a>  <span class="fu">set_engine</span>(<span class="st">"brulee"</span>, <span class="at">trace =</span> <span class="dv">0</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb54-6"><a href="#cb54-6"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb54-7"><a href="#cb54-7"></a></span>
<span id="cb54-8"><a href="#cb54-8"></a><span class="co"># Estract "dials" for parameter tuning</span></span>
<span id="cb54-9"><a href="#cb54-9"></a>mlp_param <span class="ot">&lt;-</span> <span class="fu">extract_parameter_set_dials</span>(mlp_spec)</span>
<span id="cb54-10"><a href="#cb54-10"></a></span>
<span id="cb54-11"><a href="#cb54-11"></a><span class="co"># Simple combinatorial design</span></span>
<span id="cb54-12"><a href="#cb54-12"></a>mlp_param <span class="sc">|&gt;</span> <span class="fu">grid_regular</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="at">hidden_units =</span> <span class="dv">2</span>, <span class="at">penalty =</span> <span class="dv">2</span>, <span class="at">epochs =</span> <span class="dv">2</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb55"><pre class="sourceCode numberSource output number-lines code-with-copy"><code class="sourceCode"><span id="cb55-1"><a href="#cb55-1"></a># A tibble: 8 × 3</span>
<span id="cb55-2"><a href="#cb55-2"></a>  hidden_units      penalty epochs</span>
<span id="cb55-3"><a href="#cb55-3"></a>         &lt;int&gt;        &lt;dbl&gt;  &lt;int&gt;</span>
<span id="cb55-4"><a href="#cb55-4"></a>1            1 0.0000000001      5</span>
<span id="cb55-5"><a href="#cb55-5"></a>2           10 0.0000000001      5</span>
<span id="cb55-6"><a href="#cb55-6"></a>3            1 1                 5</span>
<span id="cb55-7"><a href="#cb55-7"></a>4           10 1                 5</span>
<span id="cb55-8"><a href="#cb55-8"></a>5            1 0.0000000001    500</span>
<span id="cb55-9"><a href="#cb55-9"></a>6           10 0.0000000001    500</span>
<span id="cb55-10"><a href="#cb55-10"></a>7            1 1               500</span>
<span id="cb55-11"><a href="#cb55-11"></a>8           10 1               500</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="grid-search-for-best-neural-network-architecture-2" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Grid search for best neural network architecture</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb56" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="co"># Create a model function for tuning a multilayer perceptrion neural network</span></span>
<span id="cb56-2"><a href="#cb56-2"></a>mlp_spec <span class="ot">&lt;-</span> <span class="fu">mlp</span>(<span class="at">hidden_units =</span> <span class="fu">tune</span>(),     </span>
<span id="cb56-3"><a href="#cb56-3"></a>                <span class="at">penalty =</span> <span class="fu">tune</span>(), </span>
<span id="cb56-4"><a href="#cb56-4"></a>                <span class="at">epochs =</span> <span class="fu">tune</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb56-5"><a href="#cb56-5"></a>  <span class="fu">set_engine</span>(<span class="st">"brulee"</span>, <span class="at">trace =</span> <span class="dv">0</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb56-6"><a href="#cb56-6"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb56-7"><a href="#cb56-7"></a></span>
<span id="cb56-8"><a href="#cb56-8"></a><span class="co"># Estract "dials" for parameter tuning</span></span>
<span id="cb56-9"><a href="#cb56-9"></a>mlp_param <span class="ot">&lt;-</span> <span class="fu">extract_parameter_set_dials</span>(mlp_spec)</span>
<span id="cb56-10"><a href="#cb56-10"></a></span>
<span id="cb56-11"><a href="#cb56-11"></a><span class="co"># Random design with 1000 combinations</span></span>
<span id="cb56-12"><a href="#cb56-12"></a>mlp_param <span class="sc">|&gt;</span> <span class="fu">grid_random</span>(<span class="at">size =</span> <span class="dv">1000</span>) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb57"><pre class="sourceCode numberSource output number-lines code-with-copy"><code class="sourceCode"><span id="cb57-1"><a href="#cb57-1"></a>  hidden_units       penalty              epochs     </span>
<span id="cb57-2"><a href="#cb57-2"></a> Min.   : 1.000   Min.   :0.0000000   Min.   :  5.0  </span>
<span id="cb57-3"><a href="#cb57-3"></a> 1st Qu.: 3.000   1st Qu.:0.0000000   1st Qu.:115.0  </span>
<span id="cb57-4"><a href="#cb57-4"></a> Median : 6.000   Median :0.0000212   Median :254.5  </span>
<span id="cb57-5"><a href="#cb57-5"></a> Mean   : 5.558   Mean   :0.0483832   Mean   :251.1  </span>
<span id="cb57-6"><a href="#cb57-6"></a> 3rd Qu.: 8.000   3rd Qu.:0.0052931   3rd Qu.:382.2  </span>
<span id="cb57-7"><a href="#cb57-7"></a> Max.   :10.000   Max.   :0.9945632   Max.   :500.0  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="random-design" class="slide level2">
<h2>Random design</h2>
<ul>
<li><p>We can plot the random combinations to get an idea what they will cover</p></li>
<li><p>Bear in mind, such a grid search would be quite computationally intensive as 50 neural networks would need to be fitted!</p></li>
</ul>

<img data-src="03_classicmachinelearning_2023_files/figure-revealjs/unnamed-chunk-57-1.png" width="960" class="r-stretch"></section>
<section id="fitting-models-across-the-grid" class="slide level2">
<h2>Fitting models across the grid</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb58" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb58-2"><a href="#cb58-2"></a></span>
<span id="cb58-3"><a href="#cb58-3"></a><span class="co"># Create new workflow</span></span>
<span id="cb58-4"><a href="#cb58-4"></a>mlp_wflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span> </span>
<span id="cb58-5"><a href="#cb58-5"></a>  <span class="fu">add_recipe</span>(rec_norm) <span class="sc">|&gt;</span> </span>
<span id="cb58-6"><a href="#cb58-6"></a>  <span class="fu">add_model</span>(mlp_spec)</span>
<span id="cb58-7"><a href="#cb58-7"></a></span>
<span id="cb58-8"><a href="#cb58-8"></a><span class="co"># Adjust parameter extremes</span></span>
<span id="cb58-9"><a href="#cb58-9"></a>mlp_param <span class="ot">&lt;-</span> mlp_wflow  <span class="sc">|&gt;</span>  </span>
<span id="cb58-10"><a href="#cb58-10"></a>  <span class="fu">extract_parameter_set_dials</span>() <span class="sc">|&gt;</span> </span>
<span id="cb58-11"><a href="#cb58-11"></a>  <span class="fu">update</span>(<span class="at">epochs =</span> <span class="fu">epochs</span>(<span class="fu">c</span>(<span class="dv">200</span>, <span class="dv">600</span>)),</span>
<span id="cb58-12"><a href="#cb58-12"></a>         <span class="at">hidden_units =</span> <span class="fu">hidden_units</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">9</span>)),</span>
<span id="cb58-13"><a href="#cb58-13"></a>         <span class="at">penalty =</span> <span class="fu">penalty</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb58-14"><a href="#cb58-14"></a></span>
<span id="cb58-15"><a href="#cb58-15"></a><span class="co"># Set metric of interest</span></span>
<span id="cb58-16"><a href="#cb58-16"></a>acc <span class="ot">&lt;-</span> <span class="fu">metric_set</span>(accuracy)</span>
<span id="cb58-17"><a href="#cb58-17"></a></span>
<span id="cb58-18"><a href="#cb58-18"></a><span class="co"># Define resampling strategy</span></span>
<span id="cb58-19"><a href="#cb58-19"></a>twofold <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(lyrics_data, <span class="at">v =</span> <span class="dv">2</span>) </span>
<span id="cb58-20"><a href="#cb58-20"></a></span>
<span id="cb58-21"><a href="#cb58-21"></a><span class="co"># Run the tuning process</span></span>
<span id="cb58-22"><a href="#cb58-22"></a>mlp_reg_tune <span class="ot">&lt;-</span> mlp_wflow  <span class="sc">|&gt;</span> </span>
<span id="cb58-23"><a href="#cb58-23"></a>  <span class="fu">tune_grid</span>(</span>
<span id="cb58-24"><a href="#cb58-24"></a>    <span class="at">resamples =</span> twofold,</span>
<span id="cb58-25"><a href="#cb58-25"></a>    <span class="at">grid =</span> mlp_param  <span class="sc">|&gt;</span>  </span>
<span id="cb58-26"><a href="#cb58-26"></a>      <span class="fu">grid_regular</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="at">hidden_units =</span> <span class="dv">4</span>, <span class="at">penalty =</span> <span class="dv">4</span>, <span class="at">epochs =</span> <span class="dv">3</span>)),</span>
<span id="cb58-27"><a href="#cb58-27"></a>    <span class="at">metrics =</span> acc</span>
<span id="cb58-28"><a href="#cb58-28"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
</section>
<section id="evaluation" class="slide level2">
<h2>Evaluation</h2>
<ul>
<li><p>The result of this tuning grid search is a table that shows the best combinations of parameters in descending order</p></li>
<li><p>We can see here that 9 nodes in one hidden layer, a penalty of 0.0001 and 600 epochs lead to the best accuracy, but it is actually worse than our original model with 6 nodes and a penalty of 0.001 and 400 epochs</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb59" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="co"># Get best fit</span></span>
<span id="cb59-2"><a href="#cb59-2"></a>best_fit <span class="ot">&lt;-</span> <span class="fu">show_best</span>(mlp_reg_tune, <span class="at">n =</span> <span class="dv">48</span>) <span class="sc">|&gt;</span> </span>
<span id="cb59-3"><a href="#cb59-3"></a>  <span class="fu">select</span>(<span class="sc">-</span>.estimator, <span class="sc">-</span>.config, <span class="sc">-</span>.metric) <span class="sc">|&gt;</span> </span>
<span id="cb59-4"><a href="#cb59-4"></a>  <span class="fu">rename</span>(<span class="at">accuracy =</span> mean)</span>
<span id="cb59-5"><a href="#cb59-5"></a>best_fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb60"><pre class="sourceCode numberSource output number-lines code-with-copy"><code class="sourceCode"><span id="cb60-1"><a href="#cb60-1"></a># A tibble: 48 × 6</span>
<span id="cb60-2"><a href="#cb60-2"></a>   hidden_units      penalty epochs accuracy     n  std_err</span>
<span id="cb60-3"><a href="#cb60-3"></a>          &lt;int&gt;        &lt;dbl&gt;  &lt;int&gt;    &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt;</span>
<span id="cb60-4"><a href="#cb60-4"></a> 1            9 0.0001          600    0.746     2 0.00125 </span>
<span id="cb60-5"><a href="#cb60-5"></a> 2            3 0.1             600    0.745     2 0.00849 </span>
<span id="cb60-6"><a href="#cb60-6"></a> 3            9 0.1             600    0.745     2 0.00918 </span>
<span id="cb60-7"><a href="#cb60-7"></a> 4            6 0.0001          600    0.743     2 0.00429 </span>
<span id="cb60-8"><a href="#cb60-8"></a> 5            9 0.0000000001    600    0.742     2 0.00447 </span>
<span id="cb60-9"><a href="#cb60-9"></a> 6            6 0.0000000001    600    0.742     2 0.00211 </span>
<span id="cb60-10"><a href="#cb60-10"></a> 7            6 0.0000001       600    0.741     2 0.00257 </span>
<span id="cb60-11"><a href="#cb60-11"></a> 8            9 0.0000001       600    0.740     2 0.000674</span>
<span id="cb60-12"><a href="#cb60-12"></a> 9            3 0.0000001       600    0.740     2 0.000360</span>
<span id="cb60-13"><a href="#cb60-13"></a>10            1 0.1             600    0.739     2 0.00182 </span>
<span id="cb60-14"><a href="#cb60-14"></a># ℹ 38 more rows</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="evaluation-1" class="slide level2">
<h2>Evaluation</h2>
<ul>
<li>The effect of parameters becomes even more clear, when we visualize the grid search:</li>
</ul>

<img data-src="03_classicmachinelearning_2023_files/figure-revealjs/unnamed-chunk-61-1.png" width="864" class="r-stretch"></section>
<section id="using-the-best-neural-network-classifier" class="slide level2">
<h2>Using the best neural network classifier</h2>
<div class="cell">

</div>
<ul>
<li>The best fitting model is actually our first model:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb61" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="co"># Model architecture</span></span>
<span id="cb61-2"><a href="#cb61-2"></a>m_ann <span class="sc">|&gt;</span> <span class="fu">extract_fit_parsnip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb62"><pre class="sourceCode numberSource output number-lines code-with-copy"><code class="sourceCode"><span id="cb62-1"><a href="#cb62-1"></a>parsnip model object</span>
<span id="cb62-2"><a href="#cb62-2"></a></span>
<span id="cb62-3"><a href="#cb62-3"></a>Multilayer perceptron</span>
<span id="cb62-4"><a href="#cb62-4"></a></span>
<span id="cb62-5"><a href="#cb62-5"></a>relu activation</span>
<span id="cb62-6"><a href="#cb62-6"></a>6 hidden units,  6,020 model parameters</span>
<span id="cb62-7"><a href="#cb62-7"></a>10,445 samples, 1,000 features, 2 classes </span>
<span id="cb62-8"><a href="#cb62-8"></a>class weights rock=1, other=1 </span>
<span id="cb62-9"><a href="#cb62-9"></a>weight decay: 0.01 </span>
<span id="cb62-10"><a href="#cb62-10"></a>dropout proportion: 0 </span>
<span id="cb62-11"><a href="#cb62-11"></a>batch size: 9401 </span>
<span id="cb62-12"><a href="#cb62-12"></a>learn rate: 0.2 </span>
<span id="cb62-13"><a href="#cb62-13"></a>validation loss after 55 epochs: 0.527 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="how-does-it-perform-on-some-completely-new-songs" class="slide level2">
<h2>How does it perform on some completely new songs?</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb63" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="co"># Some test songs (not in the training nor test data)</span></span>
<span id="cb63-2"><a href="#cb63-2"></a>test_songs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb64"><pre class="sourceCode numberSource output number-lines code-with-copy"><code class="sourceCode"><span id="cb64-1"><a href="#cb64-1"></a># A tibble: 2 × 3</span>
<span id="cb64-2"><a href="#cb64-2"></a>  artist                      song               text                           </span>
<span id="cb64-3"><a href="#cb64-3"></a>  &lt;chr&gt;                       &lt;chr&gt;              &lt;chr&gt;                          </span>
<span id="cb64-4"><a href="#cb64-4"></a>1 Joan Jett &amp; the Blackhearts I love rock'n'roll "I saw him dancing there by th…</span>
<span id="cb64-5"><a href="#cb64-5"></a>2 Celine Dion                 The Power of Love  "The whispers in the morning\n…</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<ul>
<li>We can simply use the <code>predict</code> function and supply the new songs. This code could of course also be used in a software that detects genre from song lyric</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb65" data-code-line-numbers="true"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="co"># Predict genre</span></span>
<span id="cb65-2"><a href="#cb65-2"></a><span class="fu">predict</span>(m_ann, test_songs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb66"><pre class="sourceCode numberSource output number-lines code-with-copy"><code class="sourceCode"><span id="cb66-1"><a href="#cb66-1"></a># A tibble: 2 × 1</span>
<span id="cb66-2"><a href="#cb66-2"></a>  .pred_class</span>
<span id="cb66-3"><a href="#cb66-3"></a>  &lt;fct&gt;      </span>
<span id="cb66-4"><a href="#cb66-4"></a>1 rock       </span>
<span id="cb66-5"><a href="#cb66-5"></a>2 other      </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="impact-of-text-preprocessing-on-performance" class="slide level2">
<h2>Impact of text preprocessing on performance?</h2>
<ul>
<li><p>Scharkow ran a simple simulation study in which he systematically varied text preprocessing</p></li>
<li><p>The classifier was always Naive Bayes, below we see the average difference in performance</p></li>
</ul>

<img data-src="img/scharkow_table3.png" class="r-stretch"></section>
<section id="general-drivers-of-model-performance" class="slide level2">
<h2>General Drivers of model performance</h2>
<ol type="1">
<li><p>Task difficulty</p></li>
<li><p>Amount of training data</p></li>
<li><p>Choice of features (n-grams, lemmata, etc)</p></li>
<li><p>Text preprocessing (e.g., exclude or include stopwords?)</p></li>
<li><p>Representation of text (tf, tf-idf, word-embedding)</p></li>
<li><p>Tuning of algorithm (what we did in the grid search)</p></li>
</ol>
</section>
<section id="validity-of-different-approaches" class="slide level2">
<h2>Validity of different approaches</h2>
<ul>
<li><p>Van Atteveldt et al.&nbsp;(2021) re-analysised data reported in Boukes et al.&nbsp;(2020) to understand the validity of different text classification approaches for sentiment analysis</p></li>
<li><p>The data included news from a total of ten newspapers and five websites published between February 1 and July 7, 2015:</p>
<ul>
<li>three quality newspapers (NRC Handelsblad, Trouw, de Volkskrant)</li>
<li>a financial newspaper (Financieel Dagblad)</li>
<li>three popular newspapers (Algemeen Dagblad, Metro, De Telegraaf)</li>
<li>three regional outlets (Dagblad van het Noorden, de Gelderlander, Noordhollands Dagblad)</li>
</ul></li>
</ul>
</section>
<section id="main-results" class="slide level2">
<h2>Main results</h2>

<img data-src="img/vanatteveldt_table2.png" class="r-stretch"></section></section>
<section>
<section id="examples-from-the-literature" class="title-slide slide level1 center" data-background-color="steelblue">
<h1>Examples from the literature</h1>
<p>How Machine Learning is used in Communication Science</p>
</section>
<section id="example-1-incivility-in-facebook-comments" class="slide level2">
<h2>Example 1: Incivility in Facebook comments</h2>
<ul>
<li><p>Su et al.&nbsp;(2018) examined the extent and patterns of incivility in the comment sections of 42 US news outlets’ Facebook pages in 2015–2016</p></li>
<li><p>News source outlets included</p>
<ul>
<li>National-news outlets (e.g., ABC, CBS, CNN…)</li>
<li>Local-new outlets (e.g., The Denver Post, San Francisco Chronicle…)</li>
<li>Conservative and liberal partisan news outlets (e.g., Breitbart, The Daily Show…)</li>
</ul></li>
<li><p>Implemented a combination of manual coding and supervised machine learning to code:</p>
<ul>
<li>Civility</li>
<li>Interpersonal rudeness</li>
<li>Personal rudeness</li>
<li>Impersonal extreme incivility</li>
<li>Personal extreme incivility</li>
</ul></li>
</ul>
</section>
<section id="results-overall-differences" class="slide level2">
<h2>Results: Overall differences</h2>

<img data-src="img/sug_fig2.png" class="r-stretch"></section>
<section id="example-2-electoral-news-sharing-in-mexico" class="slide level2">
<h2>Example 2: Electoral news sharing in Mexico</h2>
<div class="columns">
<div class="column" style="width:85%;">
<ul>
<li><p>de León et al.&nbsp;(2021) explored how elections transform news sharing behaviour on Facebook</p></li>
<li><p>They investigated changes in news coverage and news sharing behaviour on Facebook</p>
<ul>
<li>by comparing election and routine periods, and</li>
<li>by addressing the ‘news gap’ between preferences of journalists and news consumers on social media.</li>
</ul></li>
<li><p>Employed a novel data set of news articles (N = 83,054) in Mexico</p></li>
<li><p>First coded 2,000 articles manually into topics (Politics, Crime and Disasters, Culture and Entertainment, Economic and Business, Sports, and Other), then used support vector machines to classify the rest</p></li>
</ul>
</div><div class="column" style="width:15%;">
<p><img data-src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fc/Flag_of_Mexico.svg/1024px-Flag_of_Mexico.svg.png"></p>
</div>
</div>
</section>
<section id="results" class="slide level2">
<h2>Results</h2>
<ul>
<li><p>During periods of heightened political activity, both the publication and dissemination of political news increases</p></li>
<li><p>The gap between the news choices of journalists and consumers narrows, and increased political news sharing leading to a decrease in the sharing of other news.</p></li>
</ul>

<img data-src="img/trilling_et_al.png" class="r-stretch"></section></section>
<section>
<section id="summary-conclusion-and-outlook" class="title-slide slide level1 center" data-background-color="steelblue">
<h1>Summary, Conclusion, and Outlook</h1>
<p>Next week, we reach the present!</p>
</section>
<section id="machine-learning-text-classification-pipeline" class="slide level2">
<h2>Machine Learning Text Classification Pipeline</h2>

<img data-src="img/text_analysis_fundamentals/Slide03.png" class="r-stretch"></section>
<section id="general-considerations" class="slide level2">
<h2>General considerations</h2>
<ul>
<li><p>Machine learning in the social sciences generally used to solve an engineering problem</p></li>
<li><p>Output of Machine Learning is input for “actual” statistical model (e.g., we classify text, but run an analysis of variance with the output)</p></li>
<li><p>Ethical concerns</p>
<ul>
<li><p>Is it okay to use a model we can’t possibly understand (e.g., SVM, neural networks)?</p></li>
<li><p>If they lead to false positives or false negatives, which in turn discriminate someone or lead to bias, it is difficult to find the source and denote responsibility</p></li>
</ul></li>
<li><p>We always need to validate model on unseen and representative test data!</p></li>
<li><p>Think before you run models or you will waste a lot of computational resources</p></li>
</ul>
</section>
<section id="conclusion-and-outlook" class="slide level2">
<h2>Conclusion and outlook</h2>
<ul>
<li><p>Classic machine learning is a useful tool for generalizing from a sample</p></li>
<li><p>It is very useful to reduce the amount of manual coding needed</p></li>
<li><p>That said, the field has moved on and innovations are fast-paced these days:</p>
<ul>
<li>Deep Learning, Transfer Learning, Attention, Self-Attention…. (Next week!!!)</li>
</ul></li>
</ul>
<p><br></p>
<center>
<img data-src="https://lawtomated.com/wp-content/uploads/2019/04/MLvsDL.png" style="width:60.0%">
</center>
</section></section>
<section>
<section id="thank-you-for-your-attention" class="title-slide slide level1 center" data-background-color="steelblue">
<h1>Thank you for your attention!</h1>

</section>
<section id="required-reading" class="slide level2">
<h2>Required Reading</h2>
<p><br><br></p>
<p>van Atteveldt, W., van der Velden, M. A. C. G., &amp; Boukes, M.. (2021). The Validity of Sentiment Analysis: Comparing Manual Annotation, Crowd-Coding, Dictionary Approaches, and Machine Learning Algorithms. Communication Methods and Measures, (15)2, 121-140, https://doi.org/10.1080/19312458.2020.1869198</p>
<p>Su, L. Y.-F., Xenos, M. A., Rose, K. M., Wirz, C., Scheufele, D. A., &amp; Brossard, D. (2018). Uncivil and personal? Comparing patterns of incivility in comments on the Facebook pages of news outlets. New Media &amp; Society, 20(10), 3678–3699. https://doi.org/10.1177/1461444818757205</p>
<p><br></p>
<p><em>(available on Canvas)</em></p>
</section>
<section id="references" class="slide level2 smaller">
<h2>References</h2>
<ul>
<li><p>Boumans, J. W., &amp; Trilling, D. (2016). Taking stock of the toolkit: An overview of relevant automated content analysis approaches and techniques for digital journalism scholars. Digital journalism, 4(1), 8-23.</p></li>
<li><p>de León, E., Vermeer, S. &amp; Trilling, D. (2023). Electoral news sharing: a study of changes in news coverage and Facebook sharing behaviour during the 2018 Mexican elections. Information, Communication &amp; Society, 26(6), 1193-1209. https://doi.org/10.1080/1369118X.2021.1994629</p></li>
<li><p>Hvitfeld, E. &amp; Silge, J. (2021). Supervised Machine Learning for Text Analysis in R. CRC Press. https://smltar.com/</p></li>
<li><p>Lantz, B. (2013). Machine learning in R. Packt Publishing Ltd.</p></li>
<li><p>Scharkow, M. (2013). Thematic content analysis using supervised machine learning: An empirical evaluation using german online news. Quality &amp; Quantity, 47(2), 761–773. https://doi.org/10.1007/s11135-011-9545-7</p></li>
<li><p>Su, L. Y.-F., Xenos, M. A., Rose, K. M., Wirz, C., Scheufele, D. A., &amp; Brossard, D. (2018). Uncivil and personal? Comparing patterns of incivility in comments on the Facebook pages of news outlets. New Media &amp; Society, 20(10), 3678–3699. https://doi.org/10.1177/1461444818757205</p></li>
<li><p>van Atteveldt, W., van der Velden, M. A. C. G., &amp; Boukes, M.. (2021). The Validity of Sentiment Analysis: Comparing Manual Annotation, Crowd-Coding, Dictionary Approaches, and Machine Learning Algorithms. Communication Methods and Measures, (15)2, 121-140, https://doi.org/10.1080/19312458.2020.1869198</p></li>
</ul>
</section>
<section id="example-exam-question-multiple-choice" class="slide level2">
<h2>Example Exam Question (Multiple Choice)</h2>
<p>Van Atteveldt and colleagues (2020) tested the validity of various automated text analysis approaches. What was their main result?</p>
<p><br></p>
<p>A. English dictionaries performed better than Dutch dictionaries in classifying the sentiment of Dutch news paper headlines.</p>
<p>B. Dictionary approaches were as good as machine learning approaches in classifying the sentiment of Dutch news paper headlines.</p>
<p>C. Of all automated approaches, supervised machine learning approaches performed the best in classifying the sentiment of Dutch news paper headlines.</p>
<p>D. Manual coding and supervised machine learning approaches performed similarly well in classifying the sentiment of Dutch news paper headlines.</p>
</section>
<section id="example-exam-question-multiple-choice-1" class="slide level2">
<h2>Example Exam Question (Multiple Choice)</h2>
<p>Van Atteveldt and colleagues (2020) tested the validity of various automated text analysis approaches. What was their main result?</p>
<p><br></p>
<p>A. English dictionaries performed better than Dutch dictionaries in classifying the sentiment of Dutch news paper headlines.</p>
<p>B. Dictionary approaches were as good as machine learning approaches in classifying the sentiment of Dutch news paper headlines.</p>
<p><strong>C. Of all automated approaches, supervised machine learning approaches performed the best in classifying the sentiment of Dutch news paper headlines.</strong></p>
<p>D. Manual coding and supervised machine learning approaches performed similarly well in classifying the sentiment of Dutch news paper headlines.</p>
</section>
<section id="example-exam-question-open-format" class="slide level2">
<h2>Example Exam Question (Open Format)</h2>
<p>Describe the typical process used in supervised text classification.</p>
<div class="fragment">
<p>Any supervised machine learning procedure to analyze text usually contains at least 4 steps:</p>
<ol type="1">
<li><p>One has to manually code a small set of documents for whatever variable(s) you care about (e.g., topics, sentiment, source,…).</p></li>
<li><p>One has to train a machine learning model on the hand-coded /gold-standard data, using the variable as the outcome of interest and the text features of the documents as the predictors.</p></li>
<li><p>One has to evaluate the effectiveness of the machine learning model via cross-validation. This means one has to test the model test on new (held-out) data.</p></li>
<li><p>Once one has trained a model with sufficient predictive accuracy, precision and recall, one can apply the model to more documents that have never been hand-coded or use it for the purpose it was designed for (e.g., a spam filter detection software)</p></li>
</ol>
<p><img src="img/logo.png" class="slide-logo"></p>
<div class="footer footer-default">
<p>Computational Analysis of Digital Communication</p>
</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="03_classicmachinelearning_2023_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="03_classicmachinelearning_2023_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="03_classicmachinelearning_2023_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="03_classicmachinelearning_2023_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="03_classicmachinelearning_2023_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="03_classicmachinelearning_2023_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="03_classicmachinelearning_2023_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="03_classicmachinelearning_2023_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="03_classicmachinelearning_2023_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="03_classicmachinelearning_2023_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        function fireSlideChanged(previousSlide, currentSlide) {

          // dispatch for htmlwidgets
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for reveal
        if (window.Reveal) {
          window.Reveal.addEventListener("slidechanged", function(event) {
            fireSlideChanged(event.previousSlide, event.currentSlide);
          });
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        setTimeout(function() {
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const cites = ref.parentNode.getAttribute('data-cites').split(' ');
        tippyHover(ref, function() {
          var popup = window.document.createElement('div');
          cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    });
    </script>
    

</body></html>