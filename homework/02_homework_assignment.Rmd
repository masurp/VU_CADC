---
title: 'Homework 2: Data Wrangling and Data Visualization'
author: "Philipp Masur"
date: ""
output:
  html_document:
    toc: yes
editor_options:
  chunk_output_type: console
---

```{r opts, echo = FALSE}
library(knitr)
knitr::opts_chunk$set(echo = TRUE, results = TRUE, message = FALSE, warning = FALSE)
```

# Formalities

- Name:         [ENTER YOUR NAME HERE]
- Student ID:   [ENTER YOUR STUDENT ID HERE]   

In the end, klick on "knit" and upload the respective html-output file to Canvas. Please add your name and lastname to the output file name:
e.g., 02_homework_assignment_NAME-LASTNAME.html

# Instructions

In this homework assignment, you are again going to practice what you have learned in the past two practical sessions. To do so, we again need to get some data into R. In the Canvas Module "Homework Templates & Data Sets" you will find the data set **ESS9_2018.csv**. This data set is the most recent European Social Survey (Wave 9). It can be downloaded from this website: http://www.europeansocialsurvey.org/data/, where you can find also more information about the data set. 

If you have set the working directory to the location of this RMarkdown Script and you put the csv-file in the same folder, you can load that data set without specifying a specific path. 

```{r}
# Code here
```


# Exercises

## Task 1: Selecting the right variables and understanding the data

1.1. The data set is comparatively big and we only want to work with some variables. So in a first step, select and potentially rename the following variables:

- **idno**:     respondents' id
- **cntry**:    country
- **nwspol**:   News consumptions (in minutes per day) about politics and current affairs (watching, reading, listening)
- **netustm**:  Internet use (in minutes per day)
- **polintr**:  Political interest (1 = very interested, 2 = quite interested, 3 = hardly interested, 4 = not at all interested)
- **stflife**:  Life satisfaction 
- **gndr**:     Gender
- **agea**:     Age (in years)


```{r}
# Code here
```

2.2. How many people are in the data set (Tip: use the function `nrow()`) and what is their average age? How many people are there in each country?

```{r}
# Code here
```

**Answer:** [add an interpretion here]

## Task 2: Summarizing across countries

2.1. Try to figure out on what scale political interest was measured. What is the mean and standard deviation of the variables "political interest", "political news consumption"? Tip: Install the package `psych` and use the function `describe()` to assess the variables psychometric properties. 

```{r}
# Code here
```

**Answer:** [add an interpretion here]

2.2. Check the assumption that both variables are normally distributed. Do so by plotting histograms for both variables.

```{r}
# Code here
```

**Answer:** [add an interpretion here]

2.2. Second, try to use the `group_by` and `summarise` commands to produce the average news consumptions across countries. If you can, also estimate the standard deviation per country.

```{r}
# Code here
```


2.3. If you have summarized the data, assign them to a new object and try to plot difference in news consumption between countries as a barplot. Reorder the countries to show which is consumes most political news in which the least. Which countries consume the most political news?

```{r}
# Code here
```

**Answer:** [add an interpretion here]


## Task 3: Does internet use affect well-being?

The subsequent code runs a linear model in which life satisfaction is predicted by internet use. Some further variables are entered as control variables. Based on the results of this model, Internet use is a positive, significant predictor of life satisfaction. 

3.1. How could you supplement this analysis with an appropriate graph? Is the relationship really practically relevant?

```{r}
# Linear model
model <- lm(formula = life_sat ~ age + gender-1 + internet_use, data = d) # change data object if you didnt use "d"
summary(model)

# Plot here

```

**Answer:** [add an interpretion here]

3.2. Does the relationship differ for different age groups? The following code creates a new age variable. Add this variable age_group to the aesthetics of the plot you created above (e.g., by adding `color = age_group?`) What do you see? 

```{r}
# Creating a age variable, filtering out people who did not provide age
age_data <- d %>%
  mutate(age_group = cut(age, 3)) %>% # cuts variable in three equal groups
  filter(!is.na(age_group))

# Plot here
```

**Answer:** [add an interpretion here]


3.3. Bonus questions: Can you add a simple command to the plot that creates the same type of visualization for all countries? What do you see?

```{r}
# Code here
```

**Answer:** [add an interpretion here]

